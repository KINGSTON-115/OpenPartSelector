<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ”Œ OpenPartSelector v1.1.7 - ç”µå­å…ƒå™¨ä»¶é€‰å‹ç¥å™¨</title>
    <meta name="description" content="ä¸“ä¸ºç”µå­ç±»ä¸“ä¸šå¤§å­¦ç”Ÿæ‰“é€ çš„å…ƒå™¨ä»¶é€‰å‹å·¥å…·ï¼Œå…è´¹å¼€æº v1.1.7">
    <meta name="version" content="1.1.7">
    <style>
        *{margin:0;padding:0;box-sizing:border-box}
        body{
            font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"PingFang SC","Microsoft YaHei",sans-serif;
            background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);
            min-height:100vh;
            color:#2d3748;
            overflow-x:hidden;
        }
        .container{max-width:1200px;margin:0 auto;padding:20px}
        
        /* å¤´éƒ¨ */
        .hero{
            text-align:center;
            padding:60px 20px;
            background:linear-gradient(135deg,#1a1a2e 0%,#16213e 100%);
            border-radius:0 0 50px 50px;
            margin-bottom:40px;
            box-shadow:0 20px 60px rgba(0,0,0,0.3);
        }
        .hero-logo{font-size:80px;margin-bottom:20px;animation:bounce 2s infinite}
        @keyframes bounce{0%,100%{transform:translateY(0)}50%{transform:translateY(-10px)}}
        .hero h1{
            font-size:3em;
            background:linear-gradient(90deg,#00d2ff,#3a7bd5);
            -webkit-background-clip:text;
            -webkit-text-fill-color:transparent;
            margin-bottom:15px;
            animation:fadeInUp 1s ease
        }
        @keyframes fadeInUp{from{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}
        .hero p{color:#a0aec0;font-size:1.3em;margin-bottom:25px;animation:fadeInUp 1s ease 0.2s both}
        .hero-tags{display:flex;flex-wrap:wrap;justify:center;gap:12px;animation:fadeInUp 1s ease 0.4s both}
        .hero-tag{
            padding:8px 20px;
            background:rgba(255,255,255,0.1);
            border-radius:25px;
            color:#fff;
            font-size:14px;
            backdrop-filter:blur(10px)
        }
        
        /* å¡ç‰‡ */
        .card{
            background:#fff;
            border-radius:20px;
            padding:35px;
            margin:25px 0;
            box-shadow:0 10px 40px rgba(0,0,0,0.1);
            transition:all 0.4s cubic-bezier(0.4,0,0.2,1);
            opacity:0;
            transform:translateY(30px);
        }
        .card.visible{opacity:1;transform:translateY(0)}
        .card:hover{
            transform:translateY(-8px);
            box-shadow:0 25px 80px rgba(0,0,0,0.15);
        }
        .card h2{
            font-size:1.8em;
            color:#1a202c;
            margin-bottom:20px;
            display:flex;
            align-items:center;
            gap:12px
        }
        
        /* æœç´¢æ¡† */
        .search-wrapper{
            background:linear-gradient(135deg,rgba(102,126,234,0.9) 0%,rgba(118,75,162,0.9) 100%);
            border-radius:20px;
            padding:30px;
            margin:30px 0;
            box-shadow:0 20px 60px rgba(102,126,234,0.3)
        }
        .search-box{
            display:flex;
            gap:15px;
            background:#fff;
            border-radius:15px;
            padding:10px;
            box-shadow:0 10px 40px rgba(0,0,0,0.2)
        }
        .search-box input{
            flex:1;
            padding:18px 25px;
            font-size:18px;
            border:none;
            outline:none;
            border-radius:10px;
            transition:all 0.3s
        }
        /* è‡ªåŠ¨è¡¥å…¨å»ºè®® */
        .suggestions{
            position:absolute;
            top:100%;
            left:10px;
            right:10px;
            background:#fff;
            border-radius:12px;
            box-shadow:0 20px 60px rgba(0,0,0,0.3);
            z-index:1000;
            max-height:300px;
            overflow-y:auto;
            display:none
        }
        .suggestions.show{display:block}
        .suggestion-item{
            padding:15px 20px;
            cursor:pointer;
            border-bottom:1px solid #eee;
            display:flex;
            justify-content:space-between;
            align-items:center;
            transition:all 0.2s
        }
        .suggestion-item:hover{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff}
        .suggestion-item:last-child{border-bottom:none}
        .suggestion-item .part{font-weight:bold;color:#667eea}
        .suggestion-item:hover .part{color:#fff}
        .suggestion-item .mfr{font-size:13px;color:#718096}
        .suggestion-item:hover .mfr{color:rgba(255,255,255,0.8)}
        .search-box input:focus{
            box-shadow:0 0 0 4px rgba(102,126,234,0.3)
        }
        .search-box button{
            padding:18px 40px;
            font-size:18px;
            font-weight:bold;
            background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);
            color:#fff;
            border:none;
            border-radius:12px;
            cursor:pointer;
            transition:all 0.3s;
            position:relative;
            overflow:hidden
        }
        .search-box button::before{
            content:'';position:absolute;top:0;left:-100%;width:100%;height:100%;
            background:linear-gradient(90deg,transparent,rgba(255,255,255,0.3),transparent);
            transition:left 0.5s
        }
        .search-box button:hover::before{left:100%}
        .search-box button:hover{transform:scale(1.05);box-shadow:0 15px 40px rgba(102,126,234,0.5)}
        
        /* çƒ­é—¨æœç´¢ */
        .hot-tags{display:flex;flex-wrap:wrap;gap:12px;margin-top:20px}
        .hot-tag{
            padding:12px 22px;
            background:rgba(255,255,255,0.2);
            border-radius:25px;
            color:#fff;
            cursor:pointer;
            font-size:15px;
            transition:all 0.3s;
            backdrop-filter:blur(10px)
        }
        .hot-tag:hover{
            background:rgba(255,255,255,0.3);
            transform:scale(1.1) translateY(-3px);
            box-shadow:0 10px 30px rgba(0,0,0,0.2)
        }
        
        /* ç»“æœå¡ç‰‡ */
        .result{
            background:linear-gradient(135deg,#f5f7fa 0%,#e4e8eb 100%);
            border-radius:18px;
            padding:28px;
            margin:18px 0;
            border-left:6px solid #667eea;
            transition:all 0.4s;
            opacity:0;
            transform:translateX(-30px)
        }
        .result.visible{opacity:1;transform:translateX(0)}
        .result:hover{
            transform:translateX(15px) scale(1.02);
            box-shadow:0 15px 50px rgba(102,126,234,0.2)
        }
        .result h3{
            color:#667eea;
            font-size:1.5em;
            margin-bottom:12px
        }
        .result-meta{
            display:flex;
            flex-wrap:wrap;
            gap:10px;
            margin:15px 0
        }
        .meta-tag{
            padding:8px 18px;
            background:#fff;
            border-radius:20px;
            font-size:14px;
            color:#4a5568;
            transition:all 0.3s;
            cursor:pointer;
        }
        .meta-tag:hover{transform:scale(1.05)}
        .meta-tag.price{
            background:linear-gradient(135deg,#48bb78 0%,#38a169 100%);
            color:#fff;
            font-weight:bold;
        }
        .meta-tag.stock{
            background:linear-gradient(135deg,#4299e1 0%,#3182ce 100%);
            color:#fff;
        }
        .meta-tag.fav{
            background:linear-gradient(135deg,#ed8936 0%,#dd6b20 100%);
            color:#fff;
        }
        
        /* åŠŸèƒ½ç½‘æ ¼ */
        .features{
            display:grid;
            grid-template-columns:repeat(auto-fit,minmax(250px,1fr));
            gap:25px;
            margin:40px 0
        }
        .feature{
            text-align:center;
            padding:40px 30px;
            background:linear-gradient(135deg,#f5f7fa 0%,#e4e8eb 100%);
            border-radius:20px;
            transition:all 0.4s;
            position:relative;
            overflow:hidden
        }
        .feature::before{
            content:'';position:absolute;top:0;left:0;right:0;height:5px;
            background:linear-gradient(90deg,#667eea,#764ba2);
            transform:scaleX(0);
            transition:transform 0.4s
        }
        .feature:hover::before{transform:scaleX(1)}
        .feature:hover{
            transform:translateY(-10px);
            background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);
        }
        .feature:hover .feature-icon{transform:scale(1.2) rotate(5deg)}
        .feature-icon{font-size:60px;margin-bottom:20px;transition:all 0.4s}
        .feature h3{font-size:1.4em;margin:15px 0;color:#2d3748}
        .feature:hover h3{color:#fff}
        .feature p{color:#718096;font-size:15px;line-height:1.6}
        .feature:hover p{color:rgba(255,255,255,0.9)}
        
        /* ä¸‹è½½åŒºåŸŸ */
        .download-section{
            background:linear-gradient(135deg,#1a1a2e 0%,#16213e 100%);
            border-radius:25px;
            padding:50px;
            text-align:center;
            margin:40px 0;
        }
        .download-section h2{color:#fff;font-size:2.2em;margin-bottom:15px}
        .download-section p{color:#a0aec0;font-size:1.2em;margin-bottom:35px}
        .download-buttons{display:flex;flex-wrap:wrap;justify:center;gap:20px}
        .download-btn{
            display:inline-flex;
            align-items:center;
            gap:12px;
            padding:20px 45px;
            background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);
            color:#fff;
            text-decoration:none;
            border-radius:30px;
            font-size:18px;
            font-weight:bold;
            transition:all 0.4s;
            position:relative;
            overflow:hidden
        }
        .download-btn:hover{
            transform:scale(1.1) translateY(-5px);
            box-shadow:0 20px 60px rgba(102,126,234,0.5);
        }
        .download-btn.secondary{
            background:rgba(255,255,255,0.1);
            border:2px solid rgba(255,255,255,0.3);
        }
        .download-btn.secondary:hover{background:rgba(255,255,255,0.2)}
        
        /* å•†åŸé“¾æ¥ */
        .shops{display:flex;flex-wrap:wrap;justify:center;gap:20px;margin-top:30px}
        .shop-link{
            display:flex;
            align-items:center;
            gap:10px;
            padding:15px 30px;
            background:rgba(255,255,255,0.1);
            border-radius:15px;
            color:#fff;
            text-decoration:none;
            font-size:16px;
            transition:all 0.3s;
        }
        .shop-link:hover{background:rgba(255,255,255,0.2);transform:translateY(-3px)}
        
        /* çŠ¶æ€æŒ‡ç¤º */
        .status-bar{
            display:flex;
            justify-content:center;
            gap:30px;
            padding:20px;
            background:rgba(0,0,0,0.2);
            border-radius:15px;
            margin:25px 0;
            flex-wrap:wrap
        }
        .status-item{
            display:flex;
            align-items:center;
            gap:10px;
            color:#a0aec0;
        }
        .status-dot{
            width:12px;
            height:12px;
            background:#48bb78;
            border-radius:50%;
            animation:pulse 2s infinite
        }
        @keyframes pulse{0%,100%{opacity:1;transform:scale(1)}50%{opacity:0.7;transform:scale(1.2)}}
        
        /* Toast æç¤º */
        .toast{
            position:fixed;
            top:30px;
            left:50%;
            transform:translateX(-50%) translateY(-100px);
            background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);
            color:#fff;
            padding:16px 32px;
            border-radius:30px;
            box-shadow:0 20px 60px rgba(0,0,0,0.3);
            z-index:10000;
            font-size:16px;
            font-weight:500;
            display:flex;
            align-items:center;
            gap:12px;
            transition:all 0.5s cubic-bezier(0.4,0,0.2,1);
            backdrop-filter:blur(10px)
        }
        .toast.show{transform:translateX(-50%) translateY(0)}
        .toast.success{background:linear-gradient(135deg,#48bb78 0%,#38a169 100%)}
        .toast.error{background:linear-gradient(135deg,#f56565 0%,#e53e3e 100%)}
        
        /* åŠ è½½åŠ¨ç”» */
        .loading{text-align:center;padding:50px;display:none}
        .loading.show{display:block}
        .spinner{
            width:60px;
            height:60px;
            border:6px solid rgba(255,255,255,0.1);
            border-top-color:#667eea;
            border-radius:50%;
            animation:spin 1s linear infinite;
            margin:0 auto 20px
        }
        @keyframes spin{to{transform:rotate(360deg)}}
        
        /* æ·±è‰²æ¨¡å¼åˆ‡æ¢ */
        .dark-toggle{
            position:fixed;
            top:20px;
            right:20px;
            z-index:9999;
            padding:12px 20px;
            background:rgba(255,255,255,0.2);
            border:none;
            border-radius:25px;
            color:#fff;
            cursor:pointer;
            font-size:14px;
            backdrop-filter:blur(10px);
            transition:all 0.3s
        }
        .dark-toggle:hover{background:rgba(255,255,255,0.3);transform:scale(1.05)}
        
        /* æ·±è‰²æ¨¡å¼ */
        body.dark-mode{background:linear-gradient(135deg,#1a1a2e 0%,#16213e 100%) !important;color:#fff !important}
        body.dark-mode .card{background:#1a1a2e !important;border:1px solid rgba(255,255,255,0.1) !important}
        body.dark-mode .card h2{color:#fff !important}
        body.dark-mode .result{background:linear-gradient(135deg,#1a1a2e 0%,#16213e 100%) !important}
        body.dark-mode .feature{background:rgba(255,255,255,0.05) !important}
        body.dark-mode .search-wrapper{background:linear-gradient(135deg,rgba(26,26,46,0.95) 0%,rgba(22,33,62,0.95) 100%) !important}
        body.dark-mode .download-section{background:#1a1a2e !important}
        
        /* å“åº”å¼ */
/* ç§»åŠ¨ç«¯ä¼˜åŒ– */
@media(max-width:768px){
    .hero{padding:40px 15px;border-radius:0 0 30px 30px}
    .hero h1{font-size:2em}
    .hero p{font-size:1em}
    .hero-logo{font-size:60px}
    .container{padding:10px}
    .card{padding:20px;border-radius:15px}
    .card h2{font-size:1.4em}
    .search-wrapper{padding:20px;border-radius:15px}
    .search-box{flex-direction:column;padding:10px;border-radius:12px}
    .search-box input{padding:15px;font-size:16px}
    .search-box button{padding:15px;font-size:16px;border-radius:10px}
    .hot-tags{gap:8px}
    .hot-tag{padding:10px 15px;font-size:13px}
    .result{padding:20px;border-radius:12px}
    .result h3{font-size:1.2em}
    .features{grid-template-columns:1fr;gap:15px}
    .feature{padding:25px 20px}
    .download-section{padding:30px 20px;border-radius:15px}
    .download-buttons{gap:10px}
    .download-btn{padding:15px 25px;font-size:15px}
    .shops{gap:10px}
    .shop-link{padding:12px 20px;font-size:14px}
    .status-bar{gap:15px;padding:15px}
    .cart-panel{width:100% !important;right:0 !important;border-radius:15px 15px 0 0 !important}
    .dark-toggle{top:10px;right:10px;padding:8px 15px;font-size:12px}
}

        @media(max-width:768px){
            .hero h1{font-size:2em}
            .search-box{flex-direction:column}
            .features{grid-template-columns:1fr}
            .hero{border-radius:0 0 30px 30px}
            .status-bar{gap:15px}
            .download-buttons{gap:10px}
            .download-btn{padding:15px 25px;font-size:16px}
        }
        
        /* é¡µè„šæ ·å¼ */
        .footer{
            text-align:center;
            padding:40px 20px;
            color:#718096;
            font-size:14px;
            margin-top:30px;
            border-top:1px solid rgba(255,255,255,0.1);
        }
        .footer a{color:#667eea;text-decoration:none}
        .footer a:hover{text-decoration:underline}
    
        /* æµ®åŠ¨å¯¼èˆª */
        .floating-nav{position:fixed;bottom:20px;left:20px;z-index:9999;display:flex;flex-direction:column;gap:10px;opacity:0;transform:translateX(-100px);transition:all 0.3s;}
        .floating-nav.show{opacity:1;transform:translateX(0)}
        
        /* ç­›é€‰å’Œæ’åºæ§ä»¶ */
        .search-filters{display:flex;gap:15px;margin-top:15px;flex-wrap:wrap;}
        .filter-select{padding:10px 15px;border:2px solid #e2e8f0;border-radius:10px;font-size:14px;outline:none;transition:all 0.3s;background:#fff;color:#4a5568;cursor:pointer;}
        .filter-select:focus{border-color:#667eea;box-shadow:0 0 0 3px rgba(102,126,234,0.2);}
        body.dark-mode .filter-select{background:#1a1a2e;border-color:rgba(102,126,234,0.3);color:#e2e8f0;}
    </style>
</head>
<body>
    <!-- Toast å®¹å™¨ -->
    <div id="toast" class="toast"></div>
    
    <!-- å¤´éƒ¨ -->
    <button class="dark-toggle" onclick="toggleDark()">ğŸŒ™ æ·±è‰²</button>
    
    
        <!-- é¡µå†…å¯¼èˆª -->
        <div style="position:fixed;bottom:20px;left:20px;z-index:9999;display:flex;flex-direction:column;gap:10px;">
            <button onclick="scrollToSection('search')" style="width:50px;height:50px;background:linear-gradient(135deg,#667eea,#764ba2);border:none;border-radius:50%;color:#fff;cursor:pointer;font-size:20px;box-shadow:0 5px 20px rgba(102,126,234,0.4);" title="æœç´¢">ğŸ”</button>
            <button onclick="scrollToSection('features')" style="width:50px;height:50px;background:linear-gradient(135deg,#48bb78,#38a169);border:none;border-radius:50%;color:#fff;cursor:pointer;font-size:20px;box-shadow:0 5px 20px rgba(72,187,120,0.4);" title="åŠŸèƒ½">âœ¨</button>
            <button onclick="scrollToSection('download')" style="width:50px;height:50px;background:linear-gradient(135deg,#ed8936,#dd6b20);border:none;border-radius:50%;color:#fff;cursor:pointer;font-size:20px;box-shadow:0 5px 20px rgba(237,137,54,0.4);" title="ä¸‹è½½">ğŸ“¥</button>
            <button onclick="scrollToSection('learn')" style="width:50px;height:50px;background:linear-gradient(135deg,#4299e1,#3182ce);border:none;border-radius:50%;color:#fff;cursor:pointer;font-size:20px;box-shadow:0 5px 20px rgba(66,153,225,0.4);" title="å­¦ä¹ ">ğŸ“š</button>
            <button onclick="scrollToTop()" id="backToTop" style="width:50px;height:50px;background:linear-gradient(135deg,#f56565,#e53e3e);border:none;border-radius:50%;color:#fff;cursor:pointer;font-size:20px;box-shadow:0 5px 20px rgba(245,101,101,0.4);display:none;" title="å›åˆ°é¡¶éƒ¨">â¬†ï¸</button>
        </div>
<div class="hero">
        <div class="hero-logo">ğŸ”Œ</div>
        <h1>OpenPartSelector</h1>
        <p>ä¸“ä¸ºç”µå­ç±»ä¸“ä¸šå¤§å­¦ç”Ÿæ‰“é€ çš„å…ƒå™¨ä»¶é€‰å‹ç¥å™¨ ğŸš€</p>
        <div class="hero-tags">
            <span class="hero-tag">ğŸ’° å…è´¹å¼€æº</span>
            <span class="hero-tag">ğŸ“ å­¦ç”Ÿå‹å¥½</span>
            <span class="hero-tag">ğŸ‡¨ğŸ‡³ å›½äº§æ›¿ä»£</span>
            <span class="hero-tag">ğŸ“¦ å®æ—¶æ¯”ä»·</span>
        </div>
    </div>

    <div class="container">
        <!-- æœç´¢å¡ç‰‡ --><a id="search"></a>
        <div class="card">
            <h2>ğŸ” æ™ºèƒ½é€‰å‹</h2>
            <p style="color:#718096;font-size:1.1em;margin-bottom:20px;">
                è¾“å…¥å™¨ä»¶å‹å·æˆ–éœ€æ±‚ï¼Œå®æ—¶æœç´¢å…¨ç½‘æœ€ä¼˜æ–¹æ¡ˆ
            </p>
            
            <div class="search-wrapper" style="position:relative">
        <div id="suggestions" class="suggestions"></div>
                <div class="search-box">
                    <input type="text" id="searchInput" placeholder="è¾“å…¥å‹å·ï¼šSTM32F103C8T6ã€ESP32ã€CH340...">
                    <button onclick="search()">ğŸ” ç«‹å³æœç´¢</button>
                </div>
                <div class="search-filters">
                    <select id="filterCategory" class="filter-select">
                        <option value="">ğŸ“¦ å…¨éƒ¨åˆ†ç±»</option>
                        <option value="MCU">ğŸ”Œ MCU</option>
                        <option value="Power">âš¡ ç”µæºèŠ¯ç‰‡</option>
                        <option value="Sensor">ğŸ“¡ ä¼ æ„Ÿå™¨</option>
                        <option value="Interface">ğŸ”— æ¥å£èŠ¯ç‰‡</option>
                        <option value="Memory">ğŸ’¾ å­˜å‚¨èŠ¯ç‰‡</option>
                        <option value="Wireless">ğŸ“¶ æ— çº¿æ¨¡å—</option>
                        <option value="Display">ğŸ–¥ï¸ æ˜¾ç¤ºæ¨¡å—</option>
                        <option value="Motor">ğŸï¸ ç”µæœºé©±åŠ¨</option>
                    </select>
                    <select id="sortBy" class="filter-select">
                        <option value="score">ğŸ”¥ æ¨èæ’åº</option>
                        <option value="price_asc">ğŸ’° ä»·æ ¼å‡åº</option>
                        <option value="price_desc">ğŸ’ ä»·æ ¼é™åº</option>
                        <option value="name">ğŸ”¤ åç§°æ’åº</option>
                    </select>
                </div>
                
                <p style="color:#fff;margin:15px 0 10px;font-size:15px;">ğŸ”¥ çƒ­é—¨æœç´¢ï¼š</p>
                <div class="hot-tags">
                    <button class="hot-tag" onclick="setQuery('STM32F103C8T6')">STM32F103</button>
                    <button class="hot-tag" onclick="setQuery('ESP32-WROOM')">ESP32</button>
                    <button class="hot-tag" onclick="setQuery('STC89C51')">STC89C51</button>
                    <button class="hot-tag" onclick="setQuery('CH340N')">CH340N</button>
                    <button class="hot-tag" onclick="setQuery('ATMEGA328P')">ATMEGA328P</button>
                    <button class="hot-tag" onclick="setQuery('NE555')">NE555</button>
                    <button class="hot-tag" onclick="setQuery('RP2040')">RP2040</button>
                    <button class="hot-tag" onclick="setQuery('GD32F103')">GD32å›½äº§</button>
                </div>
            </div>

            <div id="comparePanel" style="display:none;position:fixed;bottom:80px;left:20px;right:20px;max-width:800px;margin:0 auto;background:#fff;border-radius:15px;box-shadow:0 20px 60px rgba(0,0,0,0.3);z-index:9999;overflow:hidden;"><div style="padding:15px;background:linear-gradient(135deg,#805ad5,#6b46c1);color:#fff;"><h4 style="margin:0;">âš–ï¸ å™¨ä»¶å¯¹æ¯”</h4><small style="display:block;margin-top:10px;color:rgba(255,255,255,0.7);font-size:12px;">
            âŒ¨ï¸ å¿«æ·é”®: / èšç„¦æœç´¢ | â†‘â†“ é€‰æ‹©å»ºè®® | Enter æœç´¢ | Esc å–æ¶ˆ
        </small><div id="recentList" style="margin-top:15px;"></div>
        <script>updateRecentDisplay()</script></div></div><div id="cartPanel" style="display:none;position:fixed;top:80px;right:20px;width:350px;max-height:500px;background:#fff;border-radius:20px;box-shadow:0 20px 60px rgba(0,0,0,0.3);z-index:9999;overflow:hidden;">
        <div style="padding:20px;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;">
            <h3 style="margin:0;">ğŸ›’ æˆ‘çš„æ¸…å•</h3>
            <small>ç‚¹å‡»å™¨ä»¶æŸ¥çœ‹è¯¦æƒ…</small>
        </div>
        <div id="cartItems" style="padding:20px;max-height:350px;overflow-y:auto;"></div>
    </div>
    
    <div class="status-bar">
                <div class="status-item">
                    <div class="status-dot"></div>
                    <span>ğŸ”¥ å®æ—¶æœç´¢å·²å°±ç»ª</span>
                </div>
                <div class="status-item">
                    <span>ğŸ“¦ æ”¯æŒ 100+ å™¨ä»¶ç±»å‹</span>
                </div>
                <div class="status-item">
                    <span>ğŸ”— 5+ ä¸»æµå•†åŸ</span>
                </div>
            </div>

            <div class="loading" id="loading">
                <div class="spinner"></div>
                <p style="color:#718096;font-size:1.1em;">ğŸ”„ æ­£åœ¨æœç´¢...</p>
            </div>
            <div id="results"></div>
        </div>

        <!-- æ ¸å¿ƒåŠŸèƒ½ --><a id="features"></a>
        <div class="card">
            <h2>âœ¨ æ ¸å¿ƒåŠŸèƒ½</h2>
            <div class="features">
                <div class="feature">
                    <div class="feature-icon">ğŸ”</div>
                    <h3>æ™ºèƒ½æœç´¢</h3>
                    <p>è‡ªç„¶è¯­è¨€æœç´¢<br>æ¨¡ç³ŠåŒ¹é…<br>å¿«é€Ÿå®šä½</p>
                </div>
                <div class="feature">
                    <div class="feature-icon">ğŸ’°</div>
                    <h3>å…¨ç½‘æ¯”ä»·</h3>
                    <p>ç«‹åˆ›å•†åŸ<br>æ·˜å®/äº¬ä¸œ<br>æœ€ä½ä»·è´­ä¹°</p>
                </div>
                <div class="feature">
                    <div class="feature-icon">ğŸ‡¨ğŸ‡³</div>
                    <h3>å›½äº§æ›¿ä»£</h3>
                    <p>STâ†’GD32<br>ä¸€é”®æ›¿æ¢<br>é™æœ¬å¢æ•ˆ</p>
                </div>
                <div class="feature">
                    <div class="feature-icon">ğŸ“š</div>
                    <h3>å­¦ä¹ èµ„æº</h3>
                    <p>æ•°æ®æ‰‹å†Œ<br>æ•™ç¨‹é“¾æ¥<br>å¼€æºé¡¹ç›®</p>
                </div>
                <div class="feature">
                    <div class="feature-icon">ğŸ“‹</div>
                    <h3>BOM ç®¡ç†</h3>
                    <p>æ‰¹é‡é€‰å‹<br>æ¸…å•å¯¼å‡º<br>ä¸€ç«™å¼é‡‡è´­</p>
                </div>
                <div class="feature">
                    <div class="feature-icon">âš ï¸</div>
                    <h3>åœäº§é¢„è­¦</h3>
                    <p>EOL æé†’<br>æ›¿ä»£æ¨è<br>ä¾›åº”é“¾å®‰å…¨</p>
                </div>
            </div>
        </div>

        <!-- ä¸‹è½½åŒºåŸŸ --><a id="download"></a>
        <div class="download-section">
            <button onclick="startTour()" style="position:absolute;top:20px;right:20px;padding:10px 20px;background:rgba(255,255,255,0.1);border:1px solid rgba(255,255,255,0.3);border-radius:25px;color:#fff;cursor:pointer;font-size:14px;">ğŸ“ æ–°æ‰‹å¼•å¯¼</button>
            <h2>ğŸ“¥ è·å–å·¥å…·</h2>
            <p>é€‰æ‹©æœ€é€‚åˆä½ çš„ä½¿ç”¨æ–¹å¼</p>
            <div class="download-buttons">
                <a href="https://github.com/KINGSTON-115/OpenPartSelector/releases" target="_blank" class="download-btn">
                    ğŸªŸ Windows ç‰ˆ
                </a>
                <a href="https://pypi.org/project/OpenPartSelector" target="_blank" class="download-btn">
                    ğŸ“¦ pip å®‰è£…
                </a>
                <a href="https://github.com/KINGSTON-115/OpenPartSelector" target="_blank" class="download-btn secondary">
                    ğŸ’» æºç ä¸‹è½½
                </a>
            </div>
            
            <div class="shops">
                <a href="https://www.lcsc.com" target="_blank" class="shop-link">ğŸª ç«‹åˆ›å•†åŸ</a>
                <a href="https://www.taobao.com" target="_blank" class="shop-link">ğŸ›’ æ·˜å®</a>
                <a href="https://www.jd.com" target="_blank" class="shop-link">ğŸ“¦ äº¬ä¸œ</a>
                <a href="https://www.easyeda.com" target="_blank" class="shop-link">ğŸ¨ ç«‹åˆ›EDA</a>
                <a href="https://www.digikey.com" target="_blank" class="shop-link">ğŸŒ Digi-Key</a>
            </div>
        </div>

        <!-- å­¦ä¹ èµ„æº --><a id="learn"></a>
        <div class="card">
            <h2>ğŸ“š ç”µå­å­¦ä¹ èµ„æº</h2>
            <div class="features">
                <div class="feature">
                    <div class="feature-icon">ğŸ“–</div>
                    <h3>å…¥é—¨æ•™ç¨‹</h3>
                    <p>å•ç‰‡æœºå…¥é—¨<br>EDA è®¾è®¡<br>ç„Šæ¥åŸºç¡€</p>
                </div>
                <div class="feature">
                    <div class="feature-icon">ğŸ”§</div>
                    <h3>å®æˆ˜é¡¹ç›®</h3>
                    <p>å¼€æºé¡¹ç›®<br>ç«èµ›èµ„æ–™<br>æ¯•ä¸šè®¾è®¡</p>
                </div>
                <div class="feature">
                    <div class="feature-icon">ğŸ’¡</div>
                    <h3>ç»éªŒåˆ†äº«</h3>
                    <p>è¸©å‘è®°å½•<br>é€‰å‹æŠ€å·§<br>çœé’±æ”»ç•¥</p>
                </div>
                <div class="feature">
                    <div class="feature-icon">ğŸ“</div>
                    <h3>ç«èµ›æŒ‡å¯¼</h3>
                    <p>ç”µèµ›å‡†å¤‡<br>æ™ºèƒ½è½¦<br>RoboMaster</p>
                </div>
            </div>
        </div>

        <!-- é¡µè„š -->
        <div class="footer">
            <p><strong>OpenPartSelector</strong> | å…è´¹å¼€æº | MIT License</p>
            <p style="margin-top:15px">
                ğŸ“¦ GitHub: <a href="https://github.com/KINGSTON-115/OpenPartSelector">KINGSTON-115/OpenPartSelector</a>
            </p>
            <p style="margin-top:10px;color:#718096;">
                ğŸ“ ä¸“ä¸ºç”µå­ç±»ä¸“ä¸šå¤§å­¦ç”Ÿæ‰“é€  | è®©é€‰å‹æ›´ç®€å•
            </p>
        </div>
    </div>

    <script>
    // Toast æç¤ºå‡½æ•°
    function showToast(msg, type = 'info'){
        const toast = document.getElementById('toast');
        toast.textContent = msg;
        toast.className = 'toast ' + type;
        toast.classList.add('show');
        setTimeout(() => toast.classList.remove('show'), 3000);
    }
    
    // æ·±è‰²æ¨¡å¼
    let isDark = false;
    function toggleDark(){
        isDark = !isDark;
        document.body.classList.toggle('dark-mode');
        document.querySelector('.dark-toggle').innerHTML = isDark ? 'â˜€ï¸ æµ…è‰²' : 'ğŸŒ™ æ·±è‰²';
        localStorage.setItem('darkMode', isDark);
        showToast(isDark ? 'ğŸŒ™ å·²åˆ‡æ¢æ·±è‰²æ¨¡å¼' : 'â˜€ï¸ å·²åˆ‡æ¢æµ…è‰²æ¨¡å¼', 'success');
    }
    if(localStorage.getItem('darkMode') === 'true'){
        isDark = true;
        document.body.classList.add('dark-mode');
        document.querySelector('.dark-toggle').innerHTML = 'â˜€ï¸ æµ…è‰²';
    }
    
    // æœç´¢å†å²
    function saveSearch(query){
        if(!query) return;
        let history = JSON.parse(localStorage.getItem('searchHistory') || '[]');
        history = [query, ...history.filter(h => h !== query)].slice(0, 10);
        localStorage.setItem('searchHistory', JSON.stringify(history));
    }
    
    // æœ¬åœ°æ”¶è—
    function addFav(part, mfr){
        let favs = JSON.parse(localStorage.getItem('favorites') || '[]');
        if(!favs.find(f => f.part === part)){
            favs.push({part, mfr, time: new Date().toLocaleString()});
            localStorage.setItem('favorites', JSON.stringify(favs));
            showToast(`â­ å·²æ”¶è— ${part}`, 'success');
        } else {
            showToast('âš ï¸ å·²æ”¶è—è¿‡æ­¤å™¨ä»¶', 'error');
        }
    }
    
    // æœç´¢è‡ªåŠ¨è¡¥å…¨
    const suggestionsEl = document.getElementById('suggestions');
    const searchInput = document.getElementById('searchInput');
    
    searchInput.addEventListener('input', function(){
        const val = this.value.toUpperCase().trim();
        if(val.length < 1){
            suggestionsEl.classList.remove('show');
            return;
        }
        const matches = [];
        for(const [key, data] of Object.entries(partsDB)){
            if(key.toUpperCase().includes(val) || data.mfr.toUpperCase().includes(val) || data.category.toUpperCase().includes(val)){
                matches.push({part: key, ...data});
            }
        }
        if(matches.length === 0){
            suggestionsEl.classList.remove('show');
            return;
        }
        suggestionsEl.innerHTML = matches.slice(0, 8).map(m => `
            <div class="suggestion-item" onclick="setQuery('${m.part}')">
                <div><span class="part">${m.part}</span><br><span class="mfr">${m.mfr} | ${m.category}</span></div>
                <span style="color:#48bb78;font-weight:bold;">${m.price}</span>
            </div>
        `).join('') + '<div class="suggestion-item" style="justify-content:center;color:#667eea;" onclick="search()">ğŸ” æœç´¢æ›´å¤šç»“æœ</div>';
        suggestionsEl.classList.add('show');
    });
    
    searchInput.addEventListener('blur', () => {
        setTimeout(() => suggestionsEl.classList.remove('show'), 200);
    });
    
    searchInput.addEventListener('focus', () => {
        if(searchInput.value.trim()) searchInput.dispatchEvent(new Event('input'));
    });
    
    function removeFav(part){
        let favs = JSON.parse(localStorage.getItem('favorites') || '[]');
        favs = favs.filter(f => f.part !== part);
        localStorage.setItem('favorites', JSON.stringify(favs));
        showFavs();
    }
    
    function showFavs(){
        const favs = JSON.parse(localStorage.getItem('favorites') || '[]');
        const container = document.getElementById('favoritesContainer');
        if(!container) return;
        
        if(favs.length === 0){
            container.innerHTML = '<p style="color:#a0aec0;text-align:center;padding:30px;">ğŸ“­ æš‚æ— æ”¶è—ï¼Œç‚¹å‡»â­æ·»åŠ </p>';
            return;
        }
        
        container.innerHTML = '<div style="display:grid;gap:15px;">' + 
            favs.map(f => `<div style="padding:15px;background:rgba(102,126,234,0.1);border-radius:12px;display:flex;justify-content:space-between;align-items:center;">
                <div><strong style="color:#667eea;">${f.part}</strong><br><small style="color:#718096;">${f.mfr}</small></div>
                <button onclick="removeFav('${f.part}')" style="padding:8px 15px;background:#f56565;border:none;border-radius:8px;color:#fff;cursor:pointer;">åˆ é™¤</button>
            </div>`).join('') + '</div>';
    }
    
    // é¡µå†…å¯¼èˆª
    function scrollToSection(id){
        const el = document.querySelector('.card, .download-section, .hero');
        if(el) el.scrollIntoView({behavior: 'smooth'});
    }
    
    function scrollToTop(){
        window.scrollTo({top:0,behavior:'smooth'});
    }
    
    // ç›‘å¬æ»šåŠ¨æ˜¾ç¤ºå›åˆ°é¡¶éƒ¨
    window.addEventListener('scroll', () => {
        const btn = document.getElementById('backToTop');
        if(btn){
            btn.style.display = window.scrollY > 300 ? 'block' : 'none';
        }
    });
    // é”®ç›˜å¿«æ·é”®å¢å¼º
    document.addEventListener('keydown', e => {
        if(e.key === '/' && document.activeElement.tagName !== 'INPUT'){
            e.preventDefault();
            document.getElementById('searchInput').focus();
            const sugg = document.getElementById('suggestions');
            if(sugg) sugg.classList.add('show');
        }
        if(e.key === 'Escape'){
            document.getElementById('searchInput').blur();
            const sugg = document.getElementById('suggestions');
            if(sugg) sugg.classList.remove('show');
        }
        if(e.key === 'ArrowDown' && document.activeElement.tagName !== 'INPUT'){
            e.preventDefault();
            document.getElementById('searchInput').focus();
        }
    });
    
    // æœç´¢æ¡†é”®ç›˜å¯¼èˆª
    const searchInput = document.getElementById('searchInput');
    searchInput.addEventListener('keydown', e => {
        if(e.key === 'Enter') search();
        if(e.key === 'Escape'){
            searchInput.blur();
            const sugg = document.getElementById('suggestions');
            if(sugg) sugg.classList.remove('show');
        }
    });
    // å¿«æ·é”®
    document.addEventListener('keydown', e => {
        if(e.key === '/' && document.activeElement.tagName !== 'INPUT'){
            e.preventDefault();
            document.getElementById('searchInput').focus();
        }
        if(e.key === 'Escape'){
            document.getElementById('searchInput').blur();
        }
    });

    // å™¨ä»¶æ•°æ®åº“
    const partsDB = {
        // MCU - ARMç³»åˆ—
        'STM32F103': {mfr: 'STMicroelectronics', category: 'ARM Cortex-M3', type: 'MCU', alternatives: ['GD32F103', 'HK32F103'], price: 'Â¥0.95', doc: 'https://www.st.com/stm32f103'},
        'STM32F407': {mfr: 'STMicroelectronics', category: 'ARM Cortex-M4', type: 'MCU', alternatives: ['GD32F407'], price: 'Â¥3.50', doc: 'https://www.st.com/stm32f407'},
        'STM32G431': {mfr: 'STMicroelectronics', category: 'ARM Cortex-M4', type: 'MCU', alternatives: ['APM32G431'], price: 'Â¥1.45', doc: 'https://www.st.com/stm32g4'},
        'STM32H743': {mfr: 'STMicroelectronics', category: 'ARM Cortex-M7', type: 'MCU', alternatives: ['GD32H743'], price: 'Â¥6.00', doc: 'https://www.st.com/stm32h7'},
        'GD32F103': {mfr: 'å…†æ˜“åˆ›æ–°', category: 'å›½äº§ARM Cortex-M3', type: 'MCU', alternatives: ['STM32F103'], price: 'Â¥0.85', doc: 'https://www.gd32mcu.com'},
        'GD32F303': {mfr: 'å…†æ˜“åˆ›æ–°', category: 'å›½äº§ARM Cortex-M4', type: 'MCU', alternatives: ['STM32F303'], price: 'Â¥1.20', doc: 'https://www.gd32mcu.com'},
        'HK32F103': {mfr: 'èˆªé¡ºå¾®ç”µå­', category: 'å›½äº§ARM', type: 'MCU', alternatives: ['STM32F103'], price: 'Â¥0.80', doc: 'http://www.hsxp-hk.com'},
        'APM32F103': {mfr: 'èˆªèŠ¯å¾®ç”µå­', category: 'å›½äº§ARM', type: 'MCU', alternatives: ['STM32F103'], price: 'Â¥0.88', doc: 'https://www.apexic.com'},
        'RP2040': {mfr: 'Raspberry Pi', category: 'åŒæ ¸Cortex-M0+', type: 'MCU', alternatives: ['STM32G0', 'EFM32'], price: 'Â¥1.80', doc: 'https://www.raspberrypi.com/rp2040'},
        
        // MCU - ESPç³»åˆ—
        'ESP32': {mfr: 'ä¹é‘«ç§‘æŠ€', category: 'WiFi+BT+BLE', type: 'Wireless SoC', alternatives: ['ESP32-C3'], price: 'Â¥12.00', doc: 'https://www.espressif.com'},
        'ESP32-C3': {mfr: 'ä¹é‘«ç§‘æŠ€', category: 'RISC-V WiFi+BT', type: 'Wireless SoC', alternatives: ['ESP32'], price: 'Â¥8.00', doc: 'https://www.espressif.com'},
        'ESP32-S3': {mfr: 'ä¹é‘«ç§‘æŠ€', category: 'WiFi+BT+AIåŠ é€Ÿ', type: 'Wireless SoC', alternatives: ['ESP32'], price: 'Â¥15.00', doc: 'https://www.espressif.com'},
        'ESP8266': {mfr: 'ä¹é‘«ç§‘æŠ€', category: 'WiFi SoC', type: 'Wireless', alternatives: ['ESP32'], price: 'Â¥3.50', doc: 'https://www.espressif.com'},
        
        // MCU - 8051ç³»åˆ—
        'STC89C51': {mfr: 'å®æ™¶ç§‘æŠ€', category: '8051å•ç‰‡æœº', type: 'MCU', alternatives: ['AT89S51', 'N76E003'], price: 'Â¥0.60', doc: 'http://www.stcmcu.com'},
        'STC89C52': {mfr: 'å®æ™¶ç§‘æŠ€', category: '8051å•ç‰‡æœº', type: 'MCU', alternatives: ['AT89S52', 'N76E003'], price: 'Â¥0.70', doc: 'http://www.stcmcu.com'},
        'STC8A8K': {mfr: 'å®æ™¶ç§‘æŠ€', category: 'å¢å¼ºå‹8051', type: 'MCU', alternatives: ['N76E003'], price: 'Â¥1.20', doc: 'http://www.stcmcu.com'},
        'AT89S52': {mfr: 'Microchip', category: '8051å•ç‰‡æœº', type: 'MCU', alternatives: ['STC89C52'], price: 'Â¥1.00', doc: 'https://www.microchip.com'},
        'N76E003': {mfr: 'æ–°å”ç§‘æŠ€', category: '8051å•ç‰‡æœº', type: 'MCU', alternatives: ['STC89C51'], price: 'Â¥0.55', doc: 'https://www.nuvoton.com'},
        
        // MCU - AVRç³»åˆ—
        'ATMEGA328P': {mfr: 'Microchip', category: 'AVRå•ç‰‡æœº', type: 'MCU', alternatives: ['APM32'], price: 'Â¥1.80', doc: 'https://www.microchip.com'},
        'ATMEGA2560': {mfr: 'Microchip', category: 'AVRé«˜æ€§èƒ½', type: 'MCU', alternatives: ['SAM3X8E'], price: 'Â¥4.50', doc: 'https://www.microchip.com'},
        'ATMEGA32U4': {mfr: 'Microchip', category: 'AVR USB', type: 'MCU', alternatives: ['AT90USB'], price: 'Â¥2.50', doc: 'https://www.microchip.com'},
        'ATTINY85': {mfr: 'Microchip', category: 'AVRå°å‹', type: 'MCU', alternatives: ['ATMEGA'], price: 'Â¥0.80', doc: 'https://www.microchip.com'},
        
        // MCU - å…¶ä»–
        'MSP430': {mfr: 'TI', category: 'è¶…ä½åŠŸè€—MCU', type: 'MCU', alternatives: ['EFM32'], price: 'Â¥1.50', doc: 'https://www.ti.com/msp430'},
        'MSP430F5529': {mfr: 'TI', category: 'ä½åŠŸè€—USB', type: 'MCU', alternatives: ['EFM32'], price: 'Â¥2.80', doc: 'https://www.ti.com/msp430'},
        'NRF52832': {mfr: 'Nordic', category: 'BLE+ARM', type: 'Wireless MCU', alternatives: ['ESP32', 'CC2640'], price: 'Â¥3.50', doc: 'https://www.nordicsemi.com'},
        'NRF52840': {mfr: 'Nordic', category: 'BLE5.0+ARM', type: 'Wireless MCU', alternatives: ['ESP32-S3'], price: 'Â¥5.00', doc: 'https://www.nordicsemi.com'},
        'CC1310': {mfr: 'TI', category: 'Sub-1Gæ— çº¿', type: 'Wireless', alternatives: ['SI4463'], price: 'Â¥3.00', doc: 'https://www.ti.com/cc1310'},
        'CC2640': {mfr: 'TI', category: 'BLEæ— çº¿', type: 'Wireless', alternatives: ['NRF52832'], price: 'Â¥2.50', doc: 'https://www.ti.com/cc2640'},
        
        // æ¥å£èŠ¯ç‰‡
        'CH340N': {mfr: 'æ²æ’å¾®ç”µå­', category: 'USBè½¬UART', type: 'Interface', alternatives: ['CH340G', 'CP2102'], price: 'Â¥0.15', doc: 'http://www.wch.cn/ch340'},
        'CH340G': {mfr: 'æ²æ’å¾®ç”µå­', category: 'USBè½¬UART', type: 'Interface', alternatives: ['CH340N', 'CP2102'], price: 'Â¥0.18', doc: 'http://www.wch.cn/ch340'},
        'CH340K': {mfr: 'æ²æ’å¾®ç”µå­', category: 'USBè½¬UART', type: 'Interface', alternatives: ['CH340N', 'CP2102'], price: 'Â¥0.20', doc: 'http://www.wch.cn/ch340'},
        'CH341A': {mfr: 'æ²æ’å¾®ç”µå­', category: 'USBè½¬UART/SPI/I2C', type: 'Interface', alternatives: ['FT2232'], price: 'Â¥0.35', doc: 'http://www.wch.cn/ch340'},
        'CH552': {mfr: 'æ²æ’å¾®ç”µå­', category: 'USB 8051 MCU', type: 'MCU', alternatives: ['ATMEGA'], price: 'Â¥0.65', doc: 'http://www.wch.cn/ch552'},
        'CH554': {mfr: 'æ²æ’å¾®ç”µå­', category: 'USB 8051 MCU', type: 'MCU', alternatives: ['CH552'], price: 'Â¥0.70', doc: 'http://www.wch.cn/ch554'},
        'CH9141': {mfr: 'æ²æ’å¾®ç”µå­', category: 'BLEä¸²å£é€ä¼ ', type: 'Wireless', alternatives: ['HC-05'], price: 'Â¥1.50', doc: 'http://www.wch.cn/ch9141'},
        'CP2102': {mfr: 'Silicon Labs', category: 'USBè½¬UART', type: 'Interface', alternatives: ['CH340', 'FT232R'], price: 'Â¥1.20', doc: 'https://www.silabs.com'},
        'CP2102N': {mfr: 'Silicon Labs', category: 'USBè½¬UART', type: 'Interface', alternatives: ['CH340N'], price: 'Â¥1.50', doc: 'https://www.silabs.com'},
        'FT232R': {mfr: 'FTDI', category: 'USBè½¬UARTå·¥ä¸šçº§', type: 'Interface', alternatives: ['CP2102', 'CH340'], price: 'Â¥3.50', doc: 'https://www.ftdichip.com'},
        'FT2232': {mfr: 'FTDI', category: 'USBè½¬åŒä¸²å£/SPI', type: 'Interface', alternatives: ['CH9141'], price: 'Â¥8.00', doc: 'https://www.ftdichip.com'},
        'PL2303': {mfr: 'Prolific', category: 'USBè½¬UART', type: 'Interface', alternatives: ['CH340'], price: 'Â¥0.50', doc: 'https://www.prolific.com'},
        'MAX232': {mfr: 'Maxim', category: 'RS232æ”¶å‘å™¨', type: 'Interface', alternatives: ['SP232'], price: 'Â¥0.80', doc: 'https://www.maximintegrated.com'},
        'SP3232': {mfr: 'Maxim', category: 'RS232æ”¶å‘å™¨', type: 'Interface', alternatives: ['MAX232'], price: 'Â¥0.60', doc: 'https://www.maximintegrated.com'},
        
        // æ¨¡æ‹ŸèŠ¯ç‰‡
        'NE555': {mfr: 'TI/å›½äº§', category: 'ç²¾å¯†å®šæ—¶å™¨', type: 'Analog', alternatives: ['NE556', 'LM555'], price: 'Â¥0.06', doc: 'https://www.ti.com/ne555'},
        'NE556': {mfr: 'TI/å›½äº§', category: 'åŒå®šæ—¶å™¨', type: 'Analog', alternatives: ['NE555x2'], price: 'Â¥0.12', doc: 'https://www.ti.com/ne556'},
        'LM358': {mfr: 'TI/å›½äº§', category: 'åŒè¿ç®—æ”¾å¤§å™¨', type: 'Amplifier', alternatives: ['SGM358', 'TL072'], price: 'Â¥0.06', doc: 'https://www.ti.com/lm358'},
        'LM324': {mfr: 'TI/å›½äº§', category: 'å››è¿ç®—æ”¾å¤§å™¨', type: 'Amplifier', alternatives: ['LM324'], price: 'Â¥0.08', doc: 'https://www.ti.com/lm324'},
        'TL072': {mfr: 'TI', category: 'ä½å™ªå£°åŒè¿æ”¾', type: 'Amplifier', alternatives: ['NE5532', 'LM358'], price: 'Â¥0.15', doc: 'https://www.ti.com/tl072'},
        'NE5532': {mfr: 'TI', category: 'ä¸“ä¸šçº§è¿æ”¾', type: 'Amplifier', alternatives: ['TL072'], price: 'Â¥0.25', doc: 'https://www.ti.com/ne5532'},
        'SGM358': {mfr: 'åœ£é‚¦å¾®ç”µå­', category: 'å›½äº§ä½å™ªå£°è¿æ”¾', type: 'Amplifier', alternatives: ['LM358'], price: 'Â¥0.05', doc: 'http://www.sg-micro.com'},
        
        // ç”µæºèŠ¯ç‰‡
        'LM317': {mfr: 'TI/å›½äº§', category: 'å¯è°ƒç¨³å‹å™¨', type: 'Power', alternatives: ['LT317', 'AMS317'], price: 'Â¥0.15', doc: 'https://www.ti.com/lm317'},
        'LM7805': {mfr: 'TI/å›½äº§', category: '5Vç¨³å‹å™¨', type: 'Power', alternatives: ['AMS7805', 'LT7805'], price: 'Â¥0.10', doc: 'https://www.ti.com/lm7805'},
        'AMS1117': {mfr: 'AMS', category: 'LDOç¨³å‹å™¨', type: 'Power', alternatives: ['LM1117', 'ME6211'], price: 'Â¥0.06', doc: 'https://www.advanced-monolithic.com'},
        'LD1117': {mfr: 'ST', category: 'LDO 1A', type: 'Power', alternatives: ['AMS1117', 'ME6211'], price: 'Â¥0.12', doc: 'https://www.st.com/ld1117'},
        'ME6211': {mfr: 'ä¸­ç§‘å¾®', category: 'LDO 3.3V/5V', type: 'Power', alternatives: ['AMS1117', 'LD1117'], price: 'Â¥0.04', doc: 'http://www.microne.com'},
        'SX1308': {mfr: 'Semtech', category: 'å‡å‹èŠ¯ç‰‡', type: 'Power', alternatives: ['MT3608'], price: 'Â¥0.20', doc: 'https://www.semtech.com'},
        'MT3608': {mfr: 'å›½äº§', category: 'å‡å‹èŠ¯ç‰‡', type: 'Power', alternatives: ['SX1308'], price: 'Â¥0.15', doc: ''},
        
        // é€»è¾‘èŠ¯ç‰‡
        '74HC00': {mfr: 'NXP/å›½äº§', category: 'å››2è¾“å…¥ä¸éé—¨', type: 'Logic', alternatives: ['74LS00'], price: 'Â¥0.05', doc: 'https://www.nxp.com/74HC00'},
        '74HC04': {mfr: 'NXP/å›½äº§', category: 'å…­åç›¸å™¨', type: 'Logic', alternatives: ['74LS04'], price: 'Â¥0.05', doc: 'https://www.nxp.com/74HC04'},
        '74HC08': {mfr: 'NXP/å›½äº§', category: 'å››2è¾“å…¥ä¸é—¨', type: 'Logic', alternatives: ['74LS08'], price: 'Â¥0.05', doc: 'https://www.nxp.com/74HC08'},
        '74HC32': {mfr: 'NXP/å›½äº§', category: 'å››2è¾“å…¥æˆ–é—¨', type: 'Logic', alternatives: ['74LS32'], price: 'Â¥0.05', doc: 'https://www.nxp.com/74HC32'},
        '74HC74': {mfr: 'NXP/å›½äº§', category: 'åŒDè§¦å‘å™¨', type: 'Logic', alternatives: ['74LS74'], price: 'Â¥0.08', doc: 'https://www.nxp.com/74HC74'},
        '74HC125': {mfr: 'NXP/å›½äº§', category: 'å››æ€»çº¿ç¼“å†²å™¨', type: 'Logic', alternatives: ['74LS125'], price: 'Â¥0.10', doc: 'https://www.nxp.com/74HC125'},
        '74HC595': {mfr: 'NXP/å›½äº§', category: '8ä½ç§»ä½å¯„å­˜å™¨', type: 'Logic', alternatives: ['74LS595'], price: 'Â¥0.08', doc: 'https://www.nxp.com/74HC595'},
        '74HC165': {mfr: 'NXP/å›½äº§', category: '8ä½å¹¶è¡Œè¾“å…¥', type: 'Logic', alternatives: ['74LS165'], price: 'Â¥0.08', doc: 'https://www.nxp.com/74HC165'},
        '74HC4060': {mfr: 'NXP/å›½äº§', category: '14çº§åˆ†é¢‘å™¨', type: 'Logic', alternatives: ['CD4060'], price: 'Â¥0.10', doc: 'https://www.nxp.com/74HC4060'},
        'CD4017': {mfr: 'TI/å›½äº§', category: 'åè¿›åˆ¶è®¡æ•°å™¨', type: 'Logic', alternatives: ['74HC4017'], price: 'Â¥0.08', doc: 'https://www.ti.com/cd4017'},
        'CD4066': {mfr: 'TI/å›½äº§', category: 'å››åŒå‘å¼€å…³', type: 'Logic', alternatives: ['74HC4066'], price: 'Â¥0.06', doc: 'https://www.ti.com/cd4066'},
        
        // MOSFET
        'AO3400': {mfr: 'AOS', category: 'P-Channel MOSFET', type: 'MOSFET', alternatives: ['AO3401'], price: 'Â¥0.03', doc: 'https://www.aosmd.com'},
        'AO3401': {mfr: 'AOS', category: 'N-Channel MOSFET', type: 'MOSFET', alternatives: ['2N7000'], price: 'Â¥0.03', doc: 'https://www.aosmd.com'},
        '2N7000': {mfr: 'ON Semi', category: 'N-Channel MOSFET', type: 'MOSFET', alternatives: ['BS170'], price: 'Â¥0.02', doc: 'https://www.onsemi.com'},
        'IRF540N': {mfr: 'Infineon', category: 'N-Channel 100V', type: 'MOSFET', alternatives: ['IRF3205'], price: 'Â¥0.25', doc: 'https://www.infineon.com'},
        'IRF3205': {mfr: 'Infineon', category: 'N-Channel 55V', type: 'MOSFET', alternatives: ['IRF540N'], price: 'Â¥0.20', doc: 'https://www.infineon.com'},
        'IRF9540': {mfr: 'Infineon', category: 'P-Channel 100V', type: 'MOSFET', alternatives: ['AO3400'], price: 'Â¥0.35', doc: 'https://www.infineon.com'},
        
        // å­˜å‚¨èŠ¯ç‰‡
        'AT24C02': {mfr: 'Microchip', category: 'I2C EEPROM 2Kb', type: 'Memory', alternatives: ['AT24C01', 'FM24C02'], price: 'Â¥0.15', doc: 'https://www.microchip.com'},
        'AT24C16': {mfr: 'Microchip', category: 'I2C EEPROM 16Kb', type: 'Memory', alternatives: ['AT24C32'], price: 'Â¥0.25', doc: 'https://www.microchip.com'},
        'AT24C256': {mfr: 'Microchip', category: 'I2C EEPROM 256Kb', type: 'Memory', alternatives: ['FM24C256'], price: 'Â¥0.40', doc: 'https://www.microchip.com'},
        'W25Q128': {mfr: 'Winbond', category: 'SPI Flash 16MB', type: 'Memory', alternatives: ['GD25Q128'], price: 'Â¥0.80', doc: 'https://www.winbond.com'},
        'W25Q64': {mfr: 'Winbond', category: 'SPI Flash 8MB', type: 'Memory', alternatives: ['GD25Q64'], price: 'Â¥0.50', doc: 'https://www.winbond.com'},
        'FM24C256': {mfr: 'å¤æ—¦å¾®', category: 'å›½äº§EEPROM', type: 'Memory', alternatives: ['AT24C256'], price: 'Â¥0.35', doc: 'http://www.fmsh.com'},
        'GD25Q128': {mfr: 'å…†æ˜“åˆ›æ–°', category: 'å›½äº§SPI Flash', type: 'Memory', alternatives: ['W25Q128'], price: 'Â¥0.70', doc: 'https://www.gd32mcu.com'},
        
        // ä¼ æ„Ÿå™¨
        'DHT11': {mfr: 'å›½äº§', category: 'æ¸©æ¹¿åº¦ä¼ æ„Ÿå™¨', type: 'Sensor', alternatives: ['DHT22', 'SHT30'], price: 'Â¥0.50', doc: ''},
        'DHT22': {mfr: 'Aosong', category: 'é«˜ç²¾åº¦æ¸©æ¹¿åº¦', type: 'Sensor', alternatives: ['SHT30', 'BME280'], price: 'Â¥2.00', doc: ''},
        'SHT30': {mfr: 'Sensirion', category: 'I2Cæ¸©æ¹¿åº¦', type: 'Sensor', alternatives: ['SHT31', 'HDC1080'], price: 'Â¥3.50', doc: ''},
        'BME280': {mfr: 'Bosch', category: 'æ¸©æ¹¿åº¦+æ°”å‹', type: 'Sensor', alternatives: ['BMP280'], price: 'Â¥4.00', doc: ''},
        'BMP280': {mfr: 'Bosch', category: 'æ°”å‹ä¼ æ„Ÿå™¨', type: 'Sensor', alternatives: ['BME280'], price: 'Â¥2.50', doc: ''},
        'MPU6050': {mfr: 'Invensense', category: '6è½´åŠ é€Ÿåº¦è®¡+é™€èºä»ª', type: 'Sensor', alternatives: ['MPU9250'], price: 'Â¥1.50', doc: ''},
        'MPU9250': {mfr: 'Invensense', category: '9è½´è¿åŠ¨ä¼ æ„Ÿå™¨', type: 'Sensor', alternatives: ['MPU6050'], price: 'Â¥3.00', doc: ''},
        'HC-SR04': {mfr: 'å›½äº§', category: 'è¶…å£°æ³¢æµ‹è·', type: 'Sensor', alternatives: ['US-015'], price: 'Â¥0.80', doc: ''},
        'US-015': {mfr: 'å›½äº§', category: 'è¶…å£°æ³¢æµ‹è·', type: 'Sensor', alternatives: ['HC-SR04'], price: 'Â¥0.75', doc: ''},
        'HC-SR501': {mfr: 'å›½äº§', category: 'äººä½“çº¢å¤–ä¼ æ„Ÿå™¨', type: 'Sensor', alternatives: ['AM312'], price: 'Â¥0.60', doc: ''},
        'AM312': {mfr: 'å›½äº§', category: 'ä½åŠŸè€—äººä½“æ„Ÿåº”', type: 'Sensor', alternatives: ['HC-SR501'], price: 'Â¥0.55', doc: ''},
        'BH1750': {mfr: 'ROHM', category: 'æ•°å­—å…‰ç…§ä¼ æ„Ÿå™¨', type: 'Sensor', alternatives: [], price: 'Â¥1.20', doc: ''},
        'DS18B20': {mfr: 'Maxim', category: 'å•æ€»çº¿æ¸©åº¦ä¼ æ„Ÿå™¨', type: 'Sensor', alternatives: ['DS18S20'], price: 'Â¥1.00', doc: ''},
        'APDS-9960': {mfr: 'Broadcom', category: 'æ‰‹åŠ¿+é¢œè‰²+æ¥è¿‘ä¼ æ„Ÿå™¨', type: 'Sensor', alternatives: [], price: 'Â¥2.80', doc: ''},
        
        // æ˜¾ç¤ºæ¨¡å—
        'OLED0.96': {mfr: 'å›½äº§', category: 'I2C OLED 128x64', type: 'Display', alternatives: ['SSD1306'], price: 'Â¥2.50', doc: ''},
        'SSD1306': {mfr: 'Solomon', category: 'OLEDé©±åŠ¨èŠ¯ç‰‡', type: 'Display', alternatives: [], price: 'Â¥1.50', doc: ''},
        'LCD1602': {mfr: 'å›½äº§', category: 'å­—ç¬¦æ¶²æ™¶ 16x2', type: 'Display', alternatives: ['LCD2004'], price: 'Â¥2.00', doc: ''},
        'LCD2004': {mfr: 'å›½äº§', category: 'å­—ç¬¦æ¶²æ™¶ 20x4', type: 'Display', alternatives: ['LCD1602'], price: 'Â¥3.50', doc: ''},
        'TM1637': {mfr: 'Titan', category: 'æ•°ç ç®¡é©±åŠ¨', type: 'Display', alternatives: ['MAX7219'], price: 'Â¥0.40', doc: ''},
        'MAX7219': {mfr: 'Maxim', category: '8x8ç‚¹é˜µé©±åŠ¨', type: 'Display', alternatives: ['TM1637'], price: 'Â¥1.00', doc: ''},
        'WS2812B': {mfr: 'Worldsemi', category: 'RGB LEDç¯ç ', type: 'LED', alternatives: ['SK6812'], price: 'Â¥0.15', doc: ''},
        'SK6812': {mfr: 'Skiar', category: 'RGB LEDç¯ç ', type: 'LED', alternatives: ['WS2812B'], price: 'Â¥0.12', doc: ''},
        
        // ç”µæºæ¨¡å—
        'LM2596': {mfr: 'TI/å›½äº§', category: 'é™å‹ç”µæºæ¨¡å—', type: 'Power', alternatives: ['MP1584'], price: 'Â¥0.30', doc: ''},
        'MP1584': {mfr: 'å›½äº§', category: 'é™å‹ç”µæºèŠ¯ç‰‡', type: 'Power', alternatives: ['LM2596'], price: 'Â¥0.35', doc: ''},
        'AMS1117': {mfr: 'AMS', category: 'LDO 3.3V/5V', type: 'Power', alternatives: ['LM1117', 'ME6211'], price: 'Â¥0.06', doc: 'https://www.advanced-monolithic.com'},
        'TP4056': {mfr: 'å›½äº§', category: 'é”‚ç”µæ± å……ç”µç®¡ç†', type: 'Power', alternatives: ['IP5306'], price: 'Â¥0.25', doc: ''},
        'IP5306': {mfr: 'å›½äº§', category: 'ç§»åŠ¨ç”µæºç®¡ç†', type: 'Power', alternatives: ['TP4056'], price: 'Â¥0.40', doc: ''},
        'XL6009': {mfr: 'å›½äº§', category: 'å‡å‹æ¨¡å—', type: 'Power', alternatives: ['MT3608'], price: 'Â¥0.45', doc: ''},
        'UC3843': {mfr: 'TI/å›½äº§', category: 'PWMæ§åˆ¶èŠ¯ç‰‡', type: 'Power', alternatives: ['SG3525'], price: 'Â¥0.25', doc: ''},
        'NE555': {mfr: 'TI/å›½äº§', category: 'ç²¾å¯†å®šæ—¶å™¨', type: 'Analog', alternatives: ['NE556', 'LM555'], price: 'Â¥0.06', doc: 'https://www.ti.com/ne555'},
        'LM358': {mfr: 'TI/å›½äº§', category: 'åŒè¿ç®—æ”¾å¤§å™¨', type: 'Amplifier', alternatives: ['SGM358', 'TL072'], price: 'Â¥0.06', doc: 'https://www.ti.com/lm358'},
        
        // ç”µæœºé©±åŠ¨
        'L298N': {mfr: 'ST', category: 'Hæ¡¥ç”µæœºé©±åŠ¨', type: 'Motor', alternatives: ['TB6612'], price: 'Â¥1.50', doc: ''},
        'TB6612': {mfr: 'TOSHIBA', category: 'åŒHæ¡¥ç”µæœºé©±åŠ¨', type: 'Motor', alternatives: ['L298N'], price: 'Â¥1.20', doc: ''},
        'PCA9685': {mfr: 'NXP', category: '16è·¯PWMèˆµæœºé©±åŠ¨', type: 'Motor', alternatives: [], price: 'Â¥2.00', doc: ''},
        'SG90': {mfr: 'å›½äº§', category: '9gèˆµæœº', type: 'Motor', alternatives: ['MG90S'], price: 'Â¥0.80', doc: ''},
        'MG90S': {mfr: 'å›½äº§', category: 'é‡‘å±é½¿è½®èˆµæœº', type: 'Motor', alternatives: ['SG90'], price: 'Â¥1.20', doc: ''},
        
        // é€šä¿¡æ¨¡å—
        'NRF24L01': {mfr: 'Nordic', category: '2.4Gæ— çº¿æ¨¡å—', type: 'Wireless', alternatives: ['SI24R1'], price: 'Â¥0.80', doc: ''},
        'SI24R1': {mfr: 'å›½äº§', category: '2.4Gæ— çº¿æ¨¡å—', type: 'Wireless', alternatives: ['NRF24L01'], price: 'Â¥0.50', doc: ''},
        'HC-05': {mfr: 'å›½äº§', category: 'è“ç‰™ä¸²å£æ¨¡å—', type: 'Wireless', alternatives: ['HC-06', 'JDY-31'], price: 'Â¥1.00', doc: ''},
        'HC-06': {mfr: 'å›½äº§', category: 'è“ç‰™ä»æœºæ¨¡å—', type: 'Wireless', alternatives: ['HC-05'], price: 'Â¥0.90', doc: ''},
        'JDY-31': {mfr: 'å›½äº§', category: 'è“ç‰™ä¸²å£æ¨¡å—', type: 'Wireless', alternatives: ['HC-05'], price: 'Â¥0.70', doc: ''},
        'SIM800L': {mfr: 'SimCom', category: 'GSM/GPRSæ¨¡å—', type: 'Wireless', alternatives: ['SIM900A'], price: 'Â¥8.00', doc: ''},
        'A6': {mfr: 'AI-Thinker', category: 'GPRSæ¨¡å—', type: 'Wireless', alternatives: ['SIM800L'], price: 'Â¥5.00', doc: ''},
        'ESP-01S': {mfr: 'ä¹é‘«ç§‘æŠ€', category: 'ESP8266æ¨¡å—', type: 'Wireless', alternatives: ['ESP-01'], price: 'Â¥2.50', doc: ''},
        'ENJ3': {mfr: 'ä¹é‘«ç§‘æŠ€', category: 'ESP32-C3æ¨¡å—', type: 'Wireless', alternatives: [], price: 'Â¥5.00', doc: ''}
    };

    function setQuery(text){
        document.getElementById('searchInput').value = text;
        search();
    }

    // æœç´¢å‡½æ•°å¢å¼º
    function search(){
        const q = document.getElementById('searchInput').value.trim();
        const category = document.getElementById('filterCategory')?.value || '';
        const sortBy = document.getElementById('sortBy')?.value || 'score';
        
        if(!q){
            showToast('âš ï¸ è¯·è¾“å…¥æœç´¢å†…å®¹', 'error');
            return;
        }
        
        saveSearch(q);
        const l = document.getElementById('loading');
        const r = document.getElementById('results');
        l.classList.add('show');
        r.innerHTML = '';
        
        setTimeout(() => {
            let results = findParts(q);
            
            // åˆ†ç±»ç­›é€‰
            if(category){
                results = results.filter(r => r.category?.includes(category) || r.type?.includes(category));
            }
            
            // æ’åº
            if(sortBy === 'price_asc'){
                results.sort((a, b) => parseFloat((a.price||'0').replace('Â¥','')) - parseFloat((b.price||'0').replace('Â¥','')));
            } else if(sortBy === 'price_desc'){
                results.sort((a, b) => parseFloat((b.price||'0').replace('Â¥','')) - parseFloat((a.price||'0').replace('Â¥','')));
            } else if(sortBy === 'name'){
                results.sort((a, b) => a.part.localeCompare(b.part));
            }
            
            renderResults(results, q);
            l.classList.remove('show');
            showToast(`ğŸ” æ‰¾åˆ° ${results.length} ä¸ªç»“æœ`, 'success');
        }, 500);
    }

    function findParts(query){
        const q = query.toUpperCase().trim();
        let results = [];
        
        // 1. ç²¾ç¡®åŒ¹é…å‹å·
        for(const [key, data] of Object.entries(partsDB)){
            if(key === q || key.replace(/-/g,'') === q.replace(/-/g,'')){
                results.push({part: key, ...data, links: ['lcsc','taobao','jd','digikey'], score: 100});
            }
        }
        
        // 2. åˆ†ç±»å’Œå…³é”®è¯åŒ¹é…ï¼ˆå¦‚æœæ²¡æ‰¾åˆ°ç²¾ç¡®åŒ¹é…ï¼‰
        if(results.length === 0){
            const keywords = q.split(/\s+/);
            for(const [key, data] of Object.entries(partsDB)){
                let score = 0;
                // å‹å·åŒ…å«
                if(key.toUpperCase().includes(q)) score += 50;
                // åˆ¶é€ å•†åŒ¹é…
                if(data.mfr.toUpperCase().includes(q)) score += 30;
                // åˆ†ç±»åŒ¹é…
                if(data.category.toUpperCase().includes(q)) score += 25;
                // å…³é”®è¯åŒ¹é…
                for(const kw of keywords){
                    if(kw.length > 2 && (key.toUpperCase().includes(kw) || data.mfr.toUpperCase().includes(kw) || data.category.toUpperCase().includes(kw))){
                        score += 10;
                    }
                }
                if(score > 15){
                    results.push({part: key, ...data, links: ['lcsc','taobao','jd'], score: score});
                }
            }
            results.sort((a,b) => b.score - a.score);
            results = results.slice(0, 10);
        }
        
        // 3. å¦‚æœè¿˜æ˜¯æ²¡æœ‰ç»“æœï¼Œæ˜¾ç¤ºå¼•å¯¼
        if(results.length === 0){
            results.push({part: q, mfr: 'å¾…ç¡®è®¤', category: 'æœªæ‰¾åˆ°åŒ¹é…å™¨ä»¶', type: 'æç¤º', alternatives: [], price: 'è¯·å°è¯•', links: ['lcsc'], score: 0});
        }
        return results;
    }

    function renderResults(results, query){
        const r = document.getElementById('results');
        let html = `<h3 style="margin:25px 0 15px;color:#667eea;font-size:1.3em;">ğŸ“¦ æ‰¾åˆ° ${results.length} ä¸ªæ¨èç»“æœ</h3>`;
        
        results.forEach((item, i) => {
            const linksHtml = ['lcsc','taobao','jd','digikey'].map(link => {
                const names = {lcsc: 'ğŸª ç«‹åˆ›', taobao: 'ğŸ›’ æ·˜å®', jd: 'ğŸ“¦ äº¬ä¸œ', digikey: 'ğŸŒ Digi-Key'};
                const urls = {lcsc:`https://www.lcsc.com/search?q=${item.part}`, taobao:`https://s.taobao.com/search?q=${item.part}`, jd:`https://search.jd.com/Search?keyword=${item.part}`, digikey:`https://www.digikey.com/en/search?q=${item.part}`};
                return `<a href="${urls[link]}" target="_blank" class="meta-tag">${names[link]}</a>`;
            }).join('');
            
            const altHtml = item.alternatives?.length ? `<span class="meta-tag" style="background:#48bb78;color:#fff;">ğŸ‡¨ğŸ‡³ æ›¿ä»£: ${item.alternatives.join(', ')}</span>` : '';
            
            html += `<div class="result"><h3>ğŸ“¦ ${i+1}. ${item.part}</h3>
                <p style="font-size:1.1em;color:#4a5568;">${item.mfr} | ${item.category}</p>
                <div class="result-meta">
                    <span class="meta-tag price">ğŸ’° ${item.price}</span>
                    <span class="meta-tag stock">ğŸ“¦ ${item.type}</span>
                    ${altHtml}
                    <span class="meta-tag fav" onclick="addFav('${item.part}','${item.mfr}')">â­ æ”¶è—</span>
                    ${linksHtml}
                <small style="display:block;margin-top:10px;color:rgba(255,255,255,0.7);font-size:12px;">
            âŒ¨ï¸ å¿«æ·é”®: / èšç„¦æœç´¢ | â†‘â†“ é€‰æ‹©å»ºè®® | Enter æœç´¢ | Esc å–æ¶ˆ
        </small><div id="recentList" style="margin-top:15px;"></div>
        <script>updateRecentDisplay()</script></div></div>`;
        });
        r.innerHTML = html;
        // åŠ¨ç”»
        setTimeout(() => {
            document.querySelectorAll('.result').forEach((el, i) => {
                setTimeout(() => el.classList.add('visible'), i * 100);
            });
        }, 100);
    }

    document.getElementById('searchInput').addEventListener('keypress', e => {
        if(e.key === 'Enter') search();
    });
    
    // é¡µé¢æ»šåŠ¨åŠ¨ç”»
    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if(entry.isIntersecting) entry.target.classList.add('visible');
        });
    }, {threshold: 0.1});
    document.querySelectorAll('.card').forEach(card => observer.observe(card));
    
    // ä½¿ç”¨ç»Ÿè®¡
    function trackUsage(){
        const date = new Date().toDateString();
        let stats = JSON.parse(localStorage.getItem('usageStats') || '{}');
        stats[date] = (stats[date] || 0) + 1;
        localStorage.setItem('usageStats', JSON.stringify(stats));
    }
    trackUsage();
    
    // æ˜¾ç¤ºä½¿ç”¨ç»Ÿè®¡
    function showStats(){
        const stats = JSON.parse(localStorage.getItem('usageStats') || '{}');
        const days = Object.keys(stats).length;
        const total = Object.values(stats).reduce((a,b)=>a+b,0);
        showToast(`ğŸ“Š å·²ä½¿ç”¨ ${days} å¤©ï¼Œæœç´¢ ${total} æ¬¡`, 'success');
    }
    
    // è´­ç‰©è½¦åŠŸèƒ½
    let cart = JSON.parse(localStorage.getItem('cart') || '[]');
    
    function addToCart(part, mfr, price){
        if(!cart.find(c => c.part === part)){
            cart.push({part, mfr, price, time: new Date().toLocaleString()});
            localStorage.setItem('cart', JSON.stringify(cart));
            showToast(`ğŸ›’ å·²æ·»åŠ  ${part} åˆ°æ¸…å•`, 'success');
            updateCartCount();
        } else {
            showToast('âš ï¸ å·²æ·»åŠ è¿‡æ­¤å™¨ä»¶', 'error');
        }
    }
    
    function removeFromCart(part){
        cart = cart.filter(c => c.part !== part);
        localStorage.setItem('cart', JSON.stringify(cart));
        showCartItems();
        updateCartCount();
    }
    
    function updateCartCount(){
        const count = cart.length;
        const btn = document.getElementById('cartBtn');
        if(btn){
            btn.innerHTML = `ğŸ›’ æ¸…å• (${count})`;
        }
    }
    
    function showCartItems(){
        const container = document.getElementById('cartItems');
        if(!container) return;
        
        if(cart.length === 0){
            container.innerHTML = '<p style="text-align:center;color:#a0aec0;padding:30px;">ğŸ“­ æ¸…å•ä¸ºç©ºï¼Œæ·»åŠ å™¨ä»¶å¼€å§‹é€‰å‹</p>';
            return;
        }
        
        let total = 0;
        container.innerHTML = '<div style="display:grid;gap:10px;">' + 
            cart.map(c => {
                const price = parseFloat(c.price.replace('Â¥','')) || 0;
                total += price;
                return `<div style="padding:15px;background:rgba(102,126,234,0.1);border-radius:12px;display:flex;justify-content:space-between;align-items:center;">
                    <div><strong style="color:#667eea;">${c.part}</strong><br><small style="color:#718096;">${c.mfr}</small><br><span style="color:#48bb78;">${c.price}</span></div>
                    <button onclick="removeFromCart('${c.part}')" style="padding:8px 15px;background:#f56565;border:none;border-radius:8px;color:#fff;cursor:pointer;">åˆ é™¤</button>
                </div>`;
            }).join('') + `</div>
            <div style="margin-top:20px;padding:20px;background:linear-gradient(135deg,#48bb78,#38a169);border-radius:12px;text-align:center;color:#fff;">
                <div style="font-size:14px;">é¢„ä¼°æ€»ä»·</div>
                <div style="font-size:28px;font-weight:bold;">Â¥${total.toFixed(2)}</div>
            </div>
            <button onclick="exportBOM()" style="width:100%;margin-top:15px;padding:15px;background:linear-gradient(135deg,#667eea,#764ba2);border:none;border-radius:12px;color:#fff;font-size:16px;cursor:pointer;">ğŸ“¥ å¯¼å‡º BOM æ¸…å•</button>`;
        container.style.display = 'block';
    }
    
    // å¯¼å‡º BOM æ¸…å•
    function exportBOM(){
        if(cart.length === 0){
            showToast('âš ï¸ è¯·å…ˆæ·»åŠ å™¨ä»¶åˆ°æ¸…å•', 'error');
            return;
        }
        
        let total = 0;
        let csv = 'å‹å·,åˆ¶é€ å•†,ä»·æ ¼,æ·»åŠ æ—¶é—´
';
        cart.forEach(c => {
            const price = parseFloat(c.price.replace('Â¥','')) || 0;
            total += price;
            csv += `${c.part},${c.mfr},${c.price},${c.time}
`;
        });
        csv += `
æ€»è®¡,,Â¥${total.toFixed(2)},`;
        
        const blob = new Blob([csv], {type: 'text/csv;charset=utf-8'});
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `BOM_${new Date().toISOString().slice(0,10)}.csv`;
        a.click();
        URL.revokeObjectURL(url);
        showToast('ğŸ“¥ BOM æ¸…å•å·²å¯¼å‡º', 'success');
    }
    
    // åˆ†äº«åŠŸèƒ½
    function shareResult(part, mfr){
        const text = `ğŸ”Œ OpenPartSelector æ¨è

ğŸ“¦ ${part}
ğŸ­ ${mfr}
ğŸ”— https://github.com/KINGSTON-115/OpenPartSelector`;
        
        if(navigator.share){
            navigator.share({title: 'OpenPartSelector', text: text});
        } else {
            navigator.clipboard.writeText(text);
            showToast('ğŸ“‹ å·²å¤åˆ¶åˆ°å‰ªè´´æ¿', 'success');
        }
    }
    
    // æ–°æ‰‹å¼•å¯¼
    function startTour(){
        const steps = [
            {el: '#searchInput', title: 'ğŸ” æœç´¢å™¨ä»¶', text: 'è¾“å…¥å‹å·æˆ–éœ€æ±‚ï¼Œå¦‚ STM32F103ã€ESP32'},
            {el: '.suggestions', title: 'ğŸ’¡ æ™ºèƒ½è¡¥å…¨', text: 'è¾“å…¥æ—¶è‡ªåŠ¨æ˜¾ç¤ºåŒ¹é…å™¨ä»¶'},
            {el: '.result', title: 'ğŸ“¦ æŸ¥çœ‹ç»“æœ', text: 'ç‚¹å‡»å¯ç›´æ¥æ·»åŠ æˆ–æŸ¥çœ‹è¯¦æƒ…'},
            {el: '#cartBtn', title: 'ğŸ›’ æ¸…å•ç®¡ç†', text: 'æ·»åŠ å™¨ä»¶åˆ°é‡‡è´­æ¸…å•'},
            {el: '.download-section', title: 'ğŸ“¥ ä¸‹è½½ç¦»çº¿ç‰ˆ', text: 'è·å– Windows/æºç ç‰ˆæœ¬'}
        ];
        let current = 0;
        
        function showStep(){
            if(current >= steps.length){
                showToast('ğŸ‰ å¼•å¯¼å®Œæˆï¼å¼€å§‹ä½¿ç”¨å§ï¼', 'success');
                localStorage.setItem('tourDone', 'true');
                return;
            }
            const step = steps[current];
            const el = document.querySelector(step.el);
            if(el){
                el.scrollIntoView({behavior: 'smooth', block: 'center'});
                const overlay = document.createElement('div');
                overlay.id = 'tourOverlay';
                overlay.style.cssText = 'position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.7);z-index:9998;display:flex;align-items:center;justify-content:center;';
                overlay.innerHTML = `<div style="background:#fff;padding:30px;border-radius:20px;max-width:400px;text-align:center;box-shadow:0 20px 60px rgba(0,0,0,0.5);">
                    <h3 style="color:#667eea;margin-bottom:15px;">${step.title}</h3>
                    <p style="color:#4a5568;margin-bottom:20px;line-height:1.6;">${step.text}</p>
                    <button onclick="nextTour()" style="padding:12px 30px;background:linear-gradient(135deg,#667eea,#764ba2);border:none;border-radius:25px;color:#fff;cursor:pointer;font-size:16px;">${current >= steps.length - 1 ? 'ğŸ‰ å®Œæˆ' : 'ä¸‹ä¸€æ­¥ â†’'}</button>
                </div>`;
                document.body.appendChild(overlay);
            }
        }
        
        window.nextTour = function(){
            const overlay = document.getElementById('tourOverlay');
            if(overlay) overlay.remove();
            current++;
            setTimeout(showStep, 300);
        }
        
        showStep();
    }
    
    // æ˜¾ç¤ºè´­ç‰©è½¦æŒ‰é’®
    function showCartBtn(){
        const cartSection = document.querySelector('.status-bar');
        if(cartSection){
            const btn = document.createElement('button');
            btn.id = 'cartBtn';
            btn.innerHTML = 'ğŸ›’ æ¸…å• (0)';
            btn.style.cssText = 'padding:10px 20px;background:linear-gradient(135deg,#ed8936,#dd6b20);border:none;border-radius:25px;color:#fff;cursor:pointer;font-size:14px;';
            btn.onclick = () => {
                const panel = document.getElementById('cartPanel');
                panel.style.display = panel.style.display === 'block' ? 'none' : 'block';
                showCartItems();
            };
            cartSection.appendChild(btn);
        }
    }
    
    // åˆå§‹åŒ–
    showCartBtn();
    updateCartCount();
    if(!localStorage.getItem('tourDone')){
        setTimeout(startTour, 2000);
    }
    
    // åˆå§‹åŒ–æ”¶è—æ˜¾ç¤º
    if(document.getElementById('favoritesContainer')) showFavs();
    </script>
</body>
</html>
