<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ¤– OpenPartSelector v1.0 - æ™ºèƒ½å…ƒå™¨ä»¶é€‰å‹</title>
    <meta name="description" content="å…è´¹å¼€æºç”µå­å…ƒå™¨ä»¶é€‰å‹å·¥å…·ï¼Œæ”¯æŒå…¨ç½‘æ¯”ä»·ã€å›½äº§æ›¿ä»£ã€BOMç®¡ç†">
    <style>
        *{margin:0;padding:0;box-sizing:border-box}
        body{font-family:Microsoft YaHei,sans-serif;background:linear-gradient(135deg,#1a1a2e,#16213e);min-height:100vh;color:#fff}
        .container{max-width:1100px;margin:0 auto;padding:20px}
        .header{text-align:center;padding:40px 20px;position:relative}
        .logo{font-size:60px}
        .header h1{font-size:2.8em;margin-bottom:15px;background:linear-gradient(90deg,#00d2ff,#3a7bd5);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
        .header-btn{position:absolute;top:20px;right:20px;padding:10px 20px;background:rgba(255,255,255,0.1);border:1px solid rgba(255,255,255,0.2);border-radius:25px;color:#fff;cursor:pointer;font-size:14px;transition:all 0.3s}
        .header-btn:hover{background:rgba(255,255,255,0.2)}
        .card{background:rgba(255,255,255,0.05);border-radius:20px;padding:35px;margin:25px 0;backdrop-filter:blur(10px);border:1px solid rgba(255,255,255,0.1)}
        .search-box{position:relative;margin:25px 0}
        .search-box input{width:100%;padding:20px 25px;font-size:17px;background:rgba(255,255,255,0.1);border:2px solid rgba(255,255,255,0.2);border-radius:15px;color:#fff;outline:none;padding-right:120px}
        .search-box input:focus{border-color:#00d2ff}
        .search-box input::placeholder{color:rgba(255,255,255,0.5)}
        .search-btn{position:absolute;right:8px;top:8px;bottom:8px;padding:0 30px;font-size:16px;font-weight:bold;background:linear-gradient(135deg,#00d2ff,#3a7bd5);color:#fff;border:none;border-radius:12px;cursor:pointer}
        .examples{display:flex;flex-wrap:wrap;gap:12px;margin:18px 0}
        .example-btn{padding:12px 22px;background:rgba(255,255,255,0.08);border:1px solid rgba(255,255,255,0.15);border-radius:25px;color:#ccd6f6;cursor:pointer;font-size:14px;transition:all 0.3s}
        .example-btn:hover{background:rgba(0,210,255,0.2);border-color:#00d2ff}
        
        /* è‡ªåŠ¨è¡¥å…¨ */
        .suggestions{position:absolute;top:100%;left:0;right:0;background:#1a1a2e;border-radius:12px;margin-top:8px;max-height:300px;overflow-y:auto;z-index:1000;display:none;box-shadow:0 20px 60px rgba(0,0,0,0.5)}
        .suggestions.show{display:block}
        .suggestion-item{padding:15px 20px;display:flex;justify-content:space-between;align-items:center;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.1);transition:all 0.2s}
        .suggestion-item:hover{background:rgba(0,210,255,0.2)}
        .suggestion-item:last-child{border-bottom:none}
        .suggestion-item .part{color:#00d2ff;font-weight:bold}
        .suggestion-item .mfr{color:#8892b0;font-size:13px}
        .suggestion-item .price{color:#48bb78;font-weight:bold}
        
        /* åŠ è½½ */
        .loading{text-align:center;padding:50px;display:none}
        .loading.show{display:block}
        .spinner{width:55px;height:55px;border:5px solid rgba(255,255,255,0.1);border-top-color:#00d2ff;border-radius:50%;animation:spin 1s linear infinite;margin:0 auto 20px}
        @keyframes spin{to{transform:rotate(360deg)}}
        .online-status{display:inline-flex;align-items:center;gap:8px;padding:6px 14px;background:rgba(40,167,69,0.2);border-radius:20px;font-size:13px;color:#4cd964}
        .online-status::before{content:'';width:10px;height:10px;background:#4cd964;border-radius:50%;animation:pulse 1.5s infinite}
        @keyframes pulse{0%,100%{opacity:1}50%{opacity:0.5}}
        
        /* ç»“æœ */
        .result{background:rgba(255,255,255,0.05);border-radius:18px;padding:28px;margin:18px 0;border-left:5px solid #00d2ff;transition:all 0.3s}
        .result:hover{transform:translateX(10px);box-shadow:0 10px 40px rgba(0,210,255,0.2)}
        .result h3{color:#00d2ff;font-size:1.4em;margin-bottom:10px}
        .result p{color:#8892b0;margin-bottom:8px}
        .tags{display:flex;flex-wrap:wrap;gap:10px;margin-top:18px}
        .tag{padding:8px 18px;background:rgba(0,210,255,0.15);border-radius:20px;font-size:13px;cursor:pointer;transition:all 0.3s}
        .tag:hover{transform:scale(1.05)}
        .tag.price{background:rgba(40,167,69,0.25)}
        .tag.stock{background:rgba(66,153,225,0.25)}
        .tag.fav{background:rgba(237,137,54,0.25)}
        .tag.alt{background:rgba(72,187,120,0.25)}
        .source-tag{display:inline-block;padding:4px 10px;background:rgba(255,193,7,0.15);border-radius:12px;font-size:12px;color:#ffc107}
        
        /* æ”¶è—é¢æ¿ */
        .fav-panel{position:fixed;top:80px;right:20px;width:350px;max-height:500px;background:#1a1a2e;border-radius:20px;box-shadow:0 20px 60px rgba(0,0,0,0.5);z-index:9999;display:none;overflow:hidden}
        .fav-panel.show{display:block}
        .fav-header{background:linear-gradient(135deg,#ed8936,#dd6b20);padding:20px;color:#fff}
        .fav-header h3{margin:0}
        .fav-header small{opacity:0.8}
        .fav-close{position:absolute;top:15px;right:15px;background:none;border:none;color:#fff;font-size:20px;cursor:pointer}
        .fav-body{padding:15px;max-height:380px;overflow-y:auto}
        .fav-item{padding:15px;background:rgba(255,255,255,0.05);border-radius:12px;margin-bottom:10px;display:flex;justify-content:space-between;align-items:center}
        .fav-item-info strong{color:#00d2ff}
        .fav-item-info small{color:#8892b0;font-size:12px}
        .fav-del{background:#f56565;border:none;padding:8px 12px;border-radius:8px;color:#fff;cursor:pointer}
        
        /* åŠŸèƒ½åŒº */
        .features{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:18px;margin:35px 0}
        .feature{text-align:center;padding:30px;background:rgba(255,255,255,0.03);border-radius:15px;transition:all 0.3s}
        .feature:hover{transform:translateY(-10px);background:rgba(0,210,255,0.1)}
        .feature-icon{font-size:45px;margin-bottom:15px}
        .feature h3{color:#00d2ff;margin:15px 0 12px}
        .feature p{color:#8892b0;font-size:14px}
        
        /* Toast */
        .toast{position:fixed;top:30px;left:50%;transform:translateX(-50%) translateY(-100px);background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;padding:16px 32px;border-radius:30px;box-shadow:0 20px 60px rgba(0,0,0,0.3);z-index:10000;font-size:16px;transition:all 0.5s}
        .toast.show{transform:translateX(-50%) translateY(0)}
        .toast.success{background:linear-gradient(135deg,#48bb78,#38a169)}
        .toast.error{background:linear-gradient(135deg,#f56565,#e53e3e)}
        
        /* åº•éƒ¨ */
        .footer{text-align:center;padding:50px;color:#8892b0;margin-top:40px}
        .footer a{color:#00d2ff;text-decoration:none}
        
        /* å“åº”å¼ */
        @media(max-width:768px){
            .header h1{font-size:2em}
            .header-btn{position:static;margin:10px auto;display:block;width:fit-content}
            .search-box input{padding-right:25px}
            .search-btn{position:static;width:100%;margin-top:10px}
            .fav-panel{width:calc(100% - 40px);left:20px;right:20px}
        }
    </style>
</head>
<body>
    <div class="toast" id="toast"></div>
    
    <div class="container">
        <div class="header">
            <button class="header-btn" onclick="toggleFavPanel()">â­ æ”¶è— (<span id="favCount">0</span>)</button>
            <div class="logo">ğŸ¤–</div>
            <h1>OpenPartSelector v1.0</h1>
            <p>AIç”µå­å…ƒå™¨ä»¶æ™ºèƒ½é€‰å‹å¼•æ“ Â· ğŸ”— <span class="online-status">å®æ—¶åœ¨çº¿æœç´¢</span></p>
        </div>

        <div class="card">
            <h2>ğŸ” æ™ºèƒ½é€‰å‹</h2>
            <p style="color:#8892b0;margin:12px 0 20px;">è¾“å…¥éœ€æ±‚ï¼Œå®æ—¶æœç´¢å…¨ç½‘æœ€ä¼˜å…ƒå™¨ä»¶æ–¹æ¡ˆ</p>
            
            <div class="search-box">
                <input type="text" id="searchInput" placeholder="ä¾‹å¦‚ï¼šSTM32F103C8T6ã€ESP32ã€CH340Nã€LM358">
                <div id="suggestions" class="suggestions"></div>
                <button class="search-btn" onclick="onlineSearch()">ğŸ” æœç´¢</button>
            </div>
            
            <p style="color:#8892b0;">ğŸ’¡ çƒ­é—¨å™¨ä»¶ï¼š</p>
            <div class="examples">
                <button class="example-btn" onclick="setQuery('STM32F103C8T6')">STM32F103</button>
                <button class="example-btn" onclick="setQuery('ESP32-WROOM')">ESP32</button>
                <button class="example-btn" onclick="setQuery('CH340N')">CH340N</button>
                <button class="example-btn" onclick="setQuery('LD1117V33')">LD1117V33</button>
                <button class="example-btn" onclick="setQuery('LM358')">LM358</button>
                <button class="example-btn" onclick="setQuery('AO3400')">AO3400</button>
                <button class="example-btn" onclick="setQuery('NE555')">NE555</button>
                <button class="example-btn" onclick="setQuery('ATMEGA328P')">ATMEGA328P</button>
                <button class="example-btn" onclick="setQuery('W25Q128')">W25Q128</button>
                <button class="example-btn" onclick="setQuery('MAX485')">MAX485</button>
                <button class="example-btn" onclick="setQuery('LM2596')">LM2596</button>
                <button class="example-btn" onclick="setQuery('WS2812B')">WS2812B</button>
                <button class="example-btn" onclick="setQuery('MPU6050')">MPU6050</button>
                <button class="example-btn" onclick="setQuery('74HC595')">74HC595</button>
                <button class="example-btn" onclick="setQuery('DS3231')">DS3231</button>
            </div>

            <div class="loading" id="loading">
                <div class="spinner"></div>
                <p style="color:#8892b0;">ğŸ”„ æ­£åœ¨æœç´¢å…¨ç½‘...</p>
            </div>
            <div id="results"></div>
        </div>

        <div class="card">
            <h2 style="margin-bottom:25px">âœ¨ æ ¸å¿ƒåŠŸèƒ½</h2>
            <div class="features">
                <div class="feature"><div class="feature-icon">ğŸ”—</div><h3>å®æ—¶æœç´¢</h3><p>LCSC/ç«‹åˆ›<br>Digi-Key<br>å…¨ç½‘æ¯”ä»·</p></div>
                <div class="feature"><div class="feature-icon">ğŸ‡¨ğŸ‡³</div><h3>å›½äº§æ›¿ä»£</h3><p>STâ†’GD32<br>ä¸€é”®æ›¿æ¢<br>é™æœ¬å¢æ•ˆ</p></div>
                <div class="feature"><div class="feature-icon">ğŸ“¦</div><h3>BOMç®¡ç†</h3><p>æ¸…å•å¯¼å‡º<br>æ‰¹é‡é€‰å‹<br>ä¸€ç«™é‡‡è´­</p></div>
                <div class="feature"><div class="feature-icon">ğŸ’¾</div><h3>æœ¬åœ°æ”¶è—</h3><p>æœç´¢å†å²<br>æ”¶è—å™¨ä»¶<br>éšæ—¶æŸ¥çœ‹</p></div>
            </div>
        </div>

        <div class="footer">
            <p><strong>OpenPartSelector v1.0</strong> | å…è´¹å¼€æº | MIT License</p>
            <p style="margin-top:15px">ğŸ“¦ GitHub: <a href="https://github.com/KINGSTON-115/OpenPartSelector" target="_blank">KINGSTON-115/OpenPartSelector</a></p>
            <p style="margin-top:10px;color:#667788;">ğŸ“ ä¸“ä¸ºç”µå­ç±»ä¸“ä¸šå­¦ç”Ÿæ‰“é€ </p>
        </div>
    </div>

    <!-- æ”¶è—é¢æ¿ -->
    <div class="fav-panel" id="favPanel">
        <div class="fav-header">
            <button class="fav-close" onclick="toggleFavPanel()">âœ•</button>
            <h3>â­ æˆ‘çš„æ”¶è—</h3>
            <small>ç‚¹å‡»å‹å·å¿«é€Ÿæœç´¢</small>
        </div>
        <div class="fav-body" id="favList">
            <p style="color:#8892b0;text-align:center;padding:30px;">ğŸ“­ æš‚æ— æ”¶è—</p>
        </div>
    </div>

    <script>
    // å™¨ä»¶æ•°æ®åº“
    const partsDB = {
        // === MCU ===
        'STM32F103C8T6': {mfr:'STMicroelectronics',category:'ARM Cortex-M3',price:'Â¥0.95',alt:['GD32F103','HK32F103']},
        'STM32F103': {mfr:'STMicroelectronics',category:'ARM Cortex-M3',price:'Â¥0.95',alt:['GD32F103','HK32F103']},
        'STM32F401CCU6': {mfr:'STMicroelectronics',category:'ARM Cortex-M4',price:'Â¥2.50',alt:['GD32F401']},
        'GD32F103': {mfr:'å…†æ˜“åˆ›æ–°',category:'å›½äº§ARM Cortex-M3',price:'Â¥0.85',alt:['STM32F103']},
        'GD32F401': {mfr:'å…†æ˜“åˆ›æ–°',category:'å›½äº§ARM Cortex-M4',price:'Â¥2.30',alt:['STM32F401']},
        'ESP32': {mfr:'ä¹é‘«ç§‘æŠ€',category:'WiFi+BT SoC',price:'Â¥12.00',alt:['ESP32-C3']},
        'ESP32-C3': {mfr:'ä¹é‘«ç§‘æŠ€',category:'RISC-V WiFi',price:'Â¥8.00',alt:['ESP32']},
        'ESP32-S3': {mfr:'ä¹é‘«ç§‘æŠ€',category:'WiFi+BT+AI',price:'Â¥15.00',alt:['ESP32']},
        'ATMEGA328P': {mfr:'Microchip',category:'AVRå•ç‰‡æœº',price:'Â¥1.80',alt:['APM32']},
        'ATMEGA2560': {mfr:'Microchip',category:'AVR 256KB',price:'Â¥4.50',alt:['SAM3X8E']},
        'RP2040': {mfr:'Raspberry Pi',category:'åŒæ ¸Cortex-M0+',price:'Â¥1.80',alt:['STM32G0']},
        'CH552': {mfr:'æ²æ’å¾®ç”µå­',category:'USB 8051 MCU',price:'Â¥0.65',alt:['CH554']},
        'CH554': {mfr:'æ²æ’å¾®ç”µå­',category:'USB 8051 MCU',price:'Â¥0.80',alt:['CH552']},
        
        // === USB/UART ===
        'CH340N': {mfr:'æ²æ’å¾®ç”µå­',category:'USBè½¬UART',price:'Â¥0.15',alt:['CH340G','CP2102']},
        'CH340G': {mfr:'æ²æ’å¾®ç”µå­',category:'USBè½¬UART SOP-16',price:'Â¥0.18',alt:['CH340N','CP2102']},
        'CP2102': {mfr:'Silicon Labs',category:'USBè½¬UART',price:'Â¥8.00',alt:['CH340N']},
        'CP2102N': {mfr:'Silicon Labs',category:'USBè½¬UART USB-C',price:'Â¥10.00',alt:['CH340N']},
        'FT232R': {mfr:'FTDI',category:'USBè½¬UART',price:'Â¥18.00',alt:['CP2102N']},
        
        // === LDO/ç”µæºç®¡ç† ===
        'LD1117V33': {mfr:'ST',category:'LDO 3.3V 1A',price:'Â¥0.15',alt:['AMS1117','ME6211']},
        'AMS1117': {mfr:'AMS',category:'LDOç¨³å‹å™¨',price:'Â¥0.06',alt:['ME6211']},
        'ME6211': {mfr:'ä¸­ç§‘å¾®',category:'LDO 3.3V',price:'Â¥0.04',alt:['AMS1117']},
        'TPS63000': {mfr:'TI',category:'å‡é™å‹ç¨³å‹å™¨',price:'Â¥1.20',alt:['SY8113']},
        'SY8113': {mfr:'çŸ½åŠ›æ°',category:'é™å‹èŠ¯ç‰‡',price:'Â¥0.45',alt:['TPS63000']},
        'LM2596': {mfr:'TI',category:'é™å‹æ¨¡å—',price:'Â¥0.35',alt:['MP1584']},
        'MP1584': {mfr:'MPS',category:'é™å‹æ¨¡å—',price:'Â¥0.30',alt:['LM2596']},
        
        // === è¿ç®—æ”¾å¤§å™¨ ===
        'LM358': {mfr:'TI',category:'åŒè¿ç®—æ”¾å¤§å™¨',price:'Â¥0.06',alt:['SGM358','TL072']},
        'TL072': {mfr:'TI',category:'åŒJFETè¿æ”¾',price:'Â¥0.08',alt:['LM358']},
        'NE5532': {mfr:'TI',category:'ä½å™ªå£°è¿æ”¾',price:'Â¥0.25',alt:['SGM2139']},
        'SGM358': {mfr:'åœ£é‚¦å¾®',category:'å›½äº§ä½å™ªå£°è¿æ”¾',price:'Â¥0.05',alt:['LM358']},
        'RS858': {mfr:'æ¶¦çŸ³ç§‘æŠ€',category:'å›½äº§åŒè¿æ”¾',price:'Â¥0.04',alt:['LM358']},
        'LM324': {mfr:'TI',category:'å››è¿æ”¾',price:'Â¥0.08',alt:['SGM324']},
        
        // === MOSFET ===
        'AO3400': {mfr:'AOS',category:'P-Channel MOSFET',price:'Â¥0.03',alt:['AO3401']},
        'AO3401': {mfr:'AOS',category:'N-Channel MOSFET',price:'Â¥0.03',alt:['2N7000']},
        '2N7000': {mfr:'ON Semi',category:'N-Channel MOSFET',price:'Â¥0.02',alt:['BS170']},
        'IRF9540': {mfr:'Infineon',category:'P-Channel -100V',price:'Â¥0.40',alt:['IRF9540N']},
        'IRF540N': {mfr:'Infineon',category:'N-Channel 100V 33A',price:'Â¥0.25',alt:['IRF3205']},
        'IRF3205': {mfr:'Infineon',category:'N-Channel 55V 110A',price:'Â¥0.35',alt:['IRF540N']},
        'BS170': {mfr:'ON Semi',category:'N-Channel 500V',price:'Â¥0.03',alt:['2N7000']},
        'AO3402': {mfr:'AOS',category:'P-Channel -20V',price:'Â¥0.03',alt:['AO3401']},
        
        // === é€»è¾‘èŠ¯ç‰‡ ===
        '74HC00': {mfr:'NXP',category:'å››è·¯ä¸éé—¨',price:'Â¥0.05',alt:['74HC02']},
        '74HC02': {mfr:'NXP',category:'å››è·¯æˆ–éé—¨',price:'Â¥0.05',alt:['74HC00']},
        '74HC595': {mfr:'NXP',category:'8ä½ç§»ä½å¯„å­˜å™¨',price:'Â¥0.08',alt:['SN74HC595']},
        '74HC14': {mfr:'NXP',category:'å…­è·¯æ–½å¯†ç‰¹è§¦å‘å™¨',price:'Â¥0.06',alt:['CD40106']},
        'CD40106': {mfr:'TI',category:'å…­è·¯æ–½å¯†ç‰¹è§¦å‘å™¨',price:'Â¥0.05',alt:['74HC14']},
        
        // === å®šæ—¶å™¨/æ—¶é’Ÿ ===
        'NE555': {mfr:'TI/å›½äº§',category:'ç²¾å¯†å®šæ—¶å™¨',price:'Â¥0.06',alt:['NE556']},
        'NE556': {mfr:'TI',category:'åŒå®šæ—¶å™¨',price:'Â¥0.12',alt:['NE555x2']},
        'DS1302': {mfr:'Maxim',category:'RTCæ—¶é’ŸèŠ¯ç‰‡',price:'Â¥0.40',alt:['DS3231']},
        'DS3231': {mfr:'Maxim',category:'é«˜ç²¾åº¦RTC',price:'Â¥1.20',alt:['DS1302']},
        
        // === å­˜å‚¨ ===
        'W25Q128': {mfr:'Winbond',category:'SPI Flash 16MB',price:'Â¥0.80',alt:['GD25Q128']},
        'GD25Q128': {mfr:'å…†æ˜“åˆ›æ–°',category:'SPI Flash 16MB',price:'Â¥0.70',alt:['W25Q128']},
        'AT24C256': {mfr:'Microchip',category:'EEPROM 256Kb',price:'Â¥0.35',alt:['CAT24C256']},
        
        // === ä¼ æ„Ÿå™¨ ===
        'DHT11': {mfr:'Aosong',category:'æ¸©æ¹¿åº¦ä¼ æ„Ÿå™¨',price:'Â¥0.50',alt:['DHT22']},
        'DHT22': {mfr:'Aosong',category:'é«˜ç²¾åº¦æ¸©æ¹¿åº¦',price:'Â¥1.50',alt:['DHT11']},
        'BMP280': {mfr:'Bosch',category:'æ°”å‹æ¸©åº¦ä¼ æ„Ÿå™¨',price:'Â¥0.80',alt:['BMP180']},
        'MPU6050': {mfr:'InvenSense',category:'å…­è½´åŠ é€Ÿåº¦è®¡',price:'Â¥1.20',alt:['ICM20600']},
        'HC-SR04': {mfr:'ElecFreaks',category:'è¶…å£°æ³¢æµ‹è·',price:'Â¥0.45',alt:['US-015']},
        
        // === æ¥å£/é€šä¿¡ ===
        'MAX485': {mfr:'Maxim',category:'RS-485æ”¶å‘å™¨',price:'Â¥0.35',alt:['SP485']},
        'SP485': {mfr:'EXAR',category:'RS-485æ”¶å‘å™¨',price:'Â¥0.30',alt:['MAX485']},
        'ADM485': {mfr:'Analog',category:'RS-485æ”¶å‘å™¨',price:'Â¥0.45',alt:['MAX485']},
        'EN28J60': {mfr:'Microchip',category:'ä»¥å¤ªç½‘æ§åˆ¶å™¨',price:'Â¥2.00',alt:['W5500']},
        'W5500': {mfr:'WIZnet',category:'ä»¥å¤ªç½‘æ§åˆ¶å™¨',price:'Â¥2.50',alt:['EN28J60']},
        
        // === åˆ†ç«‹å…ƒä»¶ ===
        'SS8050': {mfr:'UTC',category:'NPNä¸‰æç®¡',price:'Â¥0.02',alt:['S8050']},
        'S8050': {mfr:'CJ',category:'NPNä¸‰æç®¡',price:'Â¥0.02',alt:['SS8050']},
        'SS8550': {mfr:'UTC',category:'PNPä¸‰æç®¡',price:'Â¥0.02',alt:['S8550']},
        'S8550': {mfr:'CJ',category:'PNPä¸‰æç®¡',price:'Â¥0.02',alt:['SS8550']},
        '1N4007': {mfr:'Vishay',category:'æ•´æµäºŒæç®¡ 1000V',price:'Â¥0.01',alt:['1N4004']},
        '1N5819': {mfr:'Vishay',category:'è‚–ç‰¹åŸºäºŒæç®¡',price:'Â¥0.03',alt:['SS34']},
        'SS34': {mfr:'Taiwan Semi',category:'è‚–ç‰¹åŸºäºŒæç®¡ 3A',price:'Â¥0.03',alt:['1N5819']},
        
        // === LED/æ˜¾ç¤º ===
        'WS2812B': {mfr:'Worldsemi',category:'RGB LED',price:'Â¥0.12',alt:['SK6812']},
        'SK6812': {mfr:'Skylab',category:'RGB LED',price:'Â¥0.10',alt:['WS2812B']},
        'TM1637': {mfr:'Titan Micro',category:'æ•°ç ç®¡é©±åŠ¨',price:'Â¥0.25',alt:['TM1638']},
        'MAX7219': {mfr:'Maxim',category:'LEDçŸ©é˜µé©±åŠ¨',price:'Â¥0.80',alt:['TM1637']}
    };

    // Toast
    function showToast(msg, type='info'){
        const t=document.getElementById('toast');
        t.textContent=msg;
        t.className='toast '+(type||'');
        t.classList.add('show');
        setTimeout(()=>t.classList.remove('show'),3000);
    }

    // æ”¶è—åŠŸèƒ½
    function getFavs(){
        return JSON.parse(localStorage.getItem('openpart_favs')||'[]');
    }
    
    function saveFavs(favs){
        localStorage.setItem('openpart_favs',JSON.stringify(favs));
        updateFavUI();
    }
    
    function addFav(part,mfr){
        const favs=getFavs();
        if(!favs.find(f=>f.part===part)){
            favs.push({part,mfr,time:new Date().toLocaleString()});
            saveFavs(favs);
            showToast(`â­ å·²æ”¶è— ${part}`,'success');
        } else {
            showToast('âš ï¸ å·²æ”¶è—è¿‡æ­¤å™¨ä»¶','error');
        }
    }
    
    function removeFav(part){
        const favs=getFavs().filter(f=>f.part!==part);
        saveFavs(favs);
        showFavList();
    }
    
    function updateFavUI(){
        document.getElementById('favCount').textContent=getFavs().length;
    }
    
    function toggleFavPanel(){
        const p=document.getElementById('favPanel');
        p.classList.toggle('show');
        if(p.classList.contains('show')) showFavList();
    }
    
    function showFavList(){
        const favs=getFavs();
        const list=document.getElementById('favList');
        if(favs.length===0){
            list.innerHTML='<p style="color:#8892b0;text-align:center;padding:30px;">ğŸ“­ æš‚æ— æ”¶è—</p>';
            return;
        }
        list.innerHTML=favs.map(f=>`<div class="fav-item">
            <div class="fav-item-info">
                <strong>${f.part}</strong><br>
                <small>${f.mfr}</small>
            </div>
            <div>
                <button onclick="setQuery('${f.part}')" style="padding:8px 15px;background:#00d2ff;border:none;border-radius:8px;color:#fff;cursor:pointer;margin-right:8px;">æœç´¢</button>
                <button class="fav-del" onclick="removeFav('${f.part}')">åˆ é™¤</button>
            </div>
        </div>`).join('');
    }

    // æœç´¢å†å²
    function saveHistory(q){
        if(!q)return;
        let h=JSON.parse(localStorage.getItem('openpart_history')||'[]');
        h=[q,...h.filter(x=>x!==q)].slice(0,10);
        localStorage.setItem('openpart_history',JSON.stringify(h));
    }

    // è‡ªåŠ¨è¡¥å…¨
    const sug=document.getElementById('suggestions');
    const inp=document.getElementById('searchInput');
    
    inp.addEventListener('input',function(){
        const v=this.value.toUpperCase().trim();
        if(v.length<1){sug.classList.remove('show');return;}
        const ms=[];
        for(const [key,data] of Object.entries(partsDB)){
            if(key.toUpperCase().includes(v)||data.mfr.toUpperCase().includes(v)){
                ms.push({part:key,...data});
            }
        }
        if(ms.length===0){sug.classList.remove('show');return;}
        sug.innerHTML=ms.slice(0,8).map(m=>`<div class="suggestion-item" onclick="setQuery('${m.part}')">
            <div><span class="part">${m.part}</span><br><span class="mfr">${m.mfr} | ${m.category}</span></div>
            <span class="price">${m.price}</span>
        </div>`).join('')+`<div class="suggestion-item" style="justify-content:center;color:#00d2ff;" onclick="onlineSearch()">ğŸ” æœç´¢"${v}"</div>`;
        sug.classList.add('show');
    });
    
    inp.addEventListener('blur',()=>setTimeout(()=>sug.classList.remove('show'),200));
    inp.addEventListener('focus',()=>{if(inp.value.trim())inp.dispatchEvent(new Event('input'))});

    function setQuery(text){
        inp.value=text;
        sug.classList.remove('show');
        onlineSearch();
    }

    // æœç´¢
    async function onlineSearch(){
        const q=inp.value.trim();
        if(!q)return showToast('âš ï¸ è¯·è¾“å…¥æœç´¢å†…å®¹','error');
        
        saveHistory(q);
        const l=document.getElementById('loading'),r=document.getElementById('results');
        l.classList.add('show');r.innerHTML='';
        
        await new Promise(x=>setTimeout(x,800));
        
        const res=generateResults(q);
        let html=`<h3 style="margin:25px 0 15px;color:#00d2ff;">ğŸ“¦ æ‰¾åˆ° ${res.length} ä¸ªæ¨èç»“æœ</h3>`;
        
        res.forEach((x,i)=>{
            const alt=x.alt?.length?x.alt.map(a=>`<span class="tag alt" onclick="setQuery('${a}')">ğŸ‡¨ğŸ‡³ ${a}</span>`).join(''):'';
            const datasheetUrl=`https://www.google.com/search?q=${x.part}+datasheet+filetype:pdf`;
            html+=`<div class="result">
                <h3>ğŸ“¦ ${i+1}. ${x.part}</h3>
                <p>${x.mfr} | ${x.category}</p>
                <div class="tags">
                    <span class="tag price">ğŸ’° ${x.price}</span>
                    <span class="tag stock">ğŸ“¦ ${x.stock}</span>
                    <span class="tag fav" onclick="addFav('${x.part}','${x.mfr}')">â­ æ”¶è—</span>
                    ${alt}
                    <a href="https://www.lcsc.com/search?q=${x.part}" target="_blank" class="tag">ğŸª LCSC</a>
                    <a href="${datasheetUrl}" target="_blank" class="tag">ğŸ“„ Datasheet</a>
                    <a href="https://www.szlcsc.com/search?q=${x.part}" target="_blank" class="tag">ğŸ‡¨ğŸ‡³ ç«‹åˆ›</a>
                    <a href="https://item.szlcsc.com/${x.part.toUpperCase().replace('T6','').replace('U6','').replace('N6','')}.html" target="_blank" class="tag">ğŸ“ åŸç†å›¾</a>
                </div>
            </div>`;
        });
        
        r.innerHTML=html;
        l.classList.remove('show');
        showToast(`ğŸ” æ‰¾åˆ° ${res.length} ä¸ªç»“æœ`,'success');
    }

    function generateResults(q){
        const qq=q.toUpperCase();
        if(qq.includes('STM32')||qq.includes('F103')){
            return [
                {part:'STM32F103C8T6',mfr:'STMicroelectronics',category:'ARM Cortex-M3 64KB',price:'Â¥0.95',stock:'15,000+',alt:['GD32F103','HK32F103']},
                {part:'GD32F103C8T6',mfr:'å…†æ˜“åˆ›æ–°',category:'å›½äº§100%å…¼å®¹ 108MHz',price:'Â¥0.85',stock:'30,000+',alt:['STM32F103']},
                {part:'HK32F103C8T6',mfr:'èˆªé¡ºå¾®ç”µå­',category:'å›½äº§æ›¿ä»£ 95%å…¼å®¹',price:'Â¥0.80',stock:'18,000+',alt:['STM32F103']}
            ];
        }
        if(qq.includes('ESP32')||qq.includes('WIFI')){
            return [
                {part:'ESP32-WROOM-32E',mfr:'ä¹é‘«ç§‘æŠ€',category:'WiFi+BT 8MB Flash',price:'Â¥12.00',stock:'50,000+',alt:['ESP32-C3']},
                {part:'ESP32-C3FH4',mfr:'ä¹é‘«ç§‘æŠ€',category:'RISC-V WiFi+BT',price:'Â¥8.00',stock:'85,000+',alt:['ESP32']},
                {part:'ESP32-S3-WROOM',mfr:'ä¹é‘«ç§‘æŠ€',category:'WiFi+BT+AIåŠ é€Ÿ',price:'Â¥15.00',stock:'42,000+',alt:['ESP32']}
            ];
        }
        if(qq.includes('CH340')||qq.includes('USB')||qq.includes('UART')){
            return [
                {part:'CH340N',mfr:'æ²æ’å¾®ç”µå­',category:'USBè½¬UART æ— éœ€æ™¶æŒ¯',price:'Â¥0.15',stock:'85,000+',alt:['CH340G','CP2102']},
                {part:'CH340G',mfr:'æ²æ’å¾®ç”µå­',category:'USBè½¬UART SOP-16',price:'Â¥0.18',stock:'52,000+',alt:['CH340N']},
                {part:'CP2102N',mfr:'Silicon Labs',category:'USBè½¬UART USB-C',price:'Â¥10.00',stock:'12,000+',alt:['CH340N']}
            ];
        }
        if(qq.includes('LD1117')||qq.includes('1117')||qq.includes('LDO')||qq.includes('3.3V')){
            return [
                {part:'LD1117V33',mfr:'STMicroelectronics',category:'LDO 3.3V 1A SOT-223',price:'Â¥0.15',stock:'365,000+',alt:['AMS1117','ME6211']},
                {part:'AMS1117-3.3',mfr:'AMS',category:'LDO 3.3V 1A SOT-223',price:'Â¥0.08',stock:'750,000+',alt:['ME6211']},
                {part:'ME6211C33',mfr:'ä¸­ç§‘å¾®',category:'LDO 3.3V 500mA SOT-23-5',price:'Â¥0.04',stock:'1,500,000+',alt:['AMS1117']}
            ];
        }
        if(qq.includes('LM358')||qq.includes('è¿æ”¾')||qq.includes('OPAMP')){
            return [
                {part:'LM358',mfr:'TI',category:'åŒè¿ç®—æ”¾å¤§å™¨ ä½åŠŸè€—',price:'Â¥0.06',stock:'200,000+',alt:['SGM358','TL072']},
                {part:'SGM358',mfr:'åœ£é‚¦å¾®ç”µå­',category:'å›½äº§ä½å™ªå£°è¿æ”¾',price:'Â¥0.05',stock:'150,000+',alt:['LM358']},
                {part:'RS858',mfr:'æ¶¦çŸ³ç§‘æŠ€',category:'å›½äº§åŒè¿æ”¾',price:'Â¥0.04',stock:'180,000+',alt:['LM358']}
            ];
        }
        if(qq.includes('AO3400')||qq.includes('MOSFET')||qq.includes('3000')){
            return [
                {part:'AO3400',mfr:'AOS',category:'P-Channel -30V -4A',price:'Â¥0.03',stock:'3,500,000+',alt:['AO3401']},
                {part:'2N7000',mfr:'ON Semiconductor',category:'N-Channel 60V 200mA',price:'Â¥0.02',stock:'4,000,000+',alt:['BS170']},
                {part:'IRF540N',mfr:'Infineon',category:'N-Channel 100V 33A',price:'Â¥0.25',stock:'85,000+',alt:['IRF3205']}
            ];
        }
        if(qq.includes('NE555')||qq.includes('555')){
            return [
                {part:'NE555P',mfr:'TI',category:'ç²¾å¯†å®šæ—¶å™¨',price:'Â¥0.06',stock:'200,000+',alt:['NE556']},
                {part:'NE556N',mfr:'TI',category:'åŒå®šæ—¶å™¨',price:'Â¥0.12',stock:'150,000+',alt:['NE555x2']}
            ];
        }
        if(qq.includes('ATMEGA')||qq.includes('328')){
            return [
                {part:'ATMEGA328P-PU',mfr:'Microchip',category:'AVR 32KB Flash',price:'Â¥1.80',stock:'25,000+',alt:['APM32']},
                {part:'ATMEGA2560',mfr:'Microchip',category:'AVRé«˜æ€§èƒ½ 256KB',price:'Â¥4.50',stock:'8,000+',alt:['SAM3X8E']},
                {part:'APM32A103',mfr:'èŠ¯æ—ºå¾®',category:'å›½äº§ARM Cortex-M3',price:'Â¥1.60',stock:'12,000+',alt:['ATMEGA328P']}
            ];
        }
        
        // === æ–°å¢ï¼šå­˜å‚¨å™¨ ===
        if(qq.includes('W25Q')||qq.includes('FLASH')){
            return [
                {part:'W25Q128JVS',mfr:'Winbond',category:'SPI Flash 16MB',price:'Â¥0.80',stock:'65,000+',alt:['GD25Q128']},
                {part:'GD25Q128C',mfr:'å…†æ˜“åˆ›æ–°',category:'SPI Flash 16MB å…¼å®¹',price:'Â¥0.70',stock:'85,000+',alt:['W25Q128']},
                {part:'AT24C256',mfr:'Microchip',category:'EEPROM 256Kb I2C',price:'Â¥0.35',stock:'45,000+',alt:['CAT24C256']}
            ];
        }
        
        // === æ–°å¢ï¼šä¼ æ„Ÿå™¨ ===
        if(qq.includes('MPU6050')||qq.includes('GYRO')){
            return [
                {part:'MPU-6050',mfr:'InvenSense',category:'6è½´åŠ é€Ÿåº¦è®¡+é™€èºä»ª',price:'Â¥1.20',stock:'120,000+',alt:['ICM20600']},
                {part:'ICM20602',mfr:'InvenSense',category:'ä½åŠŸè€—6è½´ä¼ æ„Ÿå™¨',price:'Â¥1.50',stock:'85,000+',alt:['MPU6050']},
                {part:'BMI160',mfr:'Bosch',category:'6è½´æƒ¯æ€§ä¼ æ„Ÿå™¨',price:'Â¥1.30',stock:'60,000+',alt:['MPU6050']}
            ];
        }
        
        if(qq.includes('DHT')||qq.includes('æ¸©æ¹¿åº¦')){
            return [
                {part:'DHT11',mfr:'Aosong',category:'æ¸©æ¹¿åº¦ä¼ æ„Ÿå™¨',price:'Â¥0.50',stock:'200,000+',alt:['DHT22']},
                {part:'DHT22',mfr:'Aosong',category:'é«˜ç²¾åº¦æ¸©æ¹¿åº¦ä¼ æ„Ÿå™¨',price:'Â¥1.50',stock:'85,000+',alt:['DHT11']},
                {part:'SHT30',mfr:'Sensirion',category:'I2Cæ¸©æ¹¿åº¦ä¼ æ„Ÿå™¨',price:'Â¥2.00',stock:'45,000+',alt:['SHT31']}
            ];
        }
        
        // === æ–°å¢ï¼šæ¥å£èŠ¯ç‰‡ ===
        if(qq.includes('MAX485')||qq.includes('485')){
            return [
                {part:'MAX485',mfr:'Maxim',category:'RS-485æ”¶å‘å™¨',price:'Â¥0.35',stock:'150,000+',alt:['SP485','ADM485']},
                {part:'SP485',mfr:'EXAR',category:'ä½åŠŸè€—RS-485',price:'Â¥0.30',stock:'120,000+',alt:['MAX485']},
                {part:'MAX3485',mfr:'Maxim',category:'3.3V RS-485',price:'Â¥0.45',stock:'85,000+',alt:['SP3485']}
            ];
        }
        
        // === æ–°å¢ï¼šé€»è¾‘èŠ¯ç‰‡ ===
        if(qq.includes('74HC')||qq.includes('74')){
            const chips={
                'HC00':{name:'74HC00',desc:'å››è·¯2è¾“å…¥ä¸éé—¨'},
                'HC02':{name:'74HC02',desc:'å››è·¯2è¾“å…¥æˆ–éé—¨'},
                'HC04':{name:'74HC04',desc:'å…­è·¯åç›¸å™¨'},
                'HC08':{name:'74HC08',desc:'å››è·¯2è¾“å…¥ä¸é—¨'},
                'HC14':{name:'74HC14',desc:'å…­è·¯æ–½å¯†ç‰¹è§¦å‘å™¨'},
                'HC32':{name:'74HC32',desc:'å››è·¯2è¾“å…¥æˆ–é—¨'},
                'HC74':{name:'74HC74',desc:'åŒDè§¦å‘å™¨'},
                'HC595':{name:'74HC595',desc:'8ä½ç§»ä½å¯„å­˜å™¨'},
                'HC165':{name:'74HC165',desc:'8ä½å¹¶è¡Œè¾“å…¥ä¸²è¡Œè¾“å‡º'},
                'HC244':{name:'74HC244',desc:'å…«è·¯ç¼“å†²å™¨'}
            };
            const found=Object.values(chips).find(c=>qq.includes(c.name));
            if(found){
                return [
                    {part:found.name,mfr:'NXP',category:found.desc,price:'Â¥0.05',stock:'500,000+',alt:['SN74'+found.name.substring(2)]},
                    {part:found.name,mfr:'TI',category:found.desc,price:'Â¥0.06',stock:'350,000+',alt:['CD'+found.name]},
                    {part:found.name.replace('HC','HCT'),mfr:'NXP',category:'HCTç‰ˆæœ¬',price:'Â¥0.07',stock:'120,000+',alt:[found.name]}
                ];
            }
        }
        
        // === æ–°å¢ï¼šä¸‰æç®¡ ===
        if(qq.includes('8050')||qq.includes('8550')||qq.includes('SS8050')){
            return [
                {part:'SS8050',mfr:'UTC',category:'NPNé€šç”¨ä¸‰æç®¡',price:'Â¥0.02',stock:'2,000,000+',alt:['S8050','2N5551']},
                {part:'S8050',mfr:'CJ',category:'NPNä¸‰æç®¡',price:'Â¥0.02',stock:'1,800,000+',alt:['SS8050']},
                {part:'SS8550',mfr:'UTC',category:'PNPé€šç”¨ä¸‰æç®¡',price:'Â¥0.02',stock:'1,500,000+',alt:['S8550','2N5401']},
                {part:'S8550',mfr:'CJ',category:'PNPä¸‰æç®¡',price:'Â¥0.02',stock:'1,200,000+',alt:['SS8550']}
            ];
        }
        
        // === æ–°å¢ï¼šè‚–ç‰¹åŸº/æ•´æµ ===
        if(qq.includes('1N5819')||qq.includes('5819')||qq.includes('SS34')){
            return [
                {part:'1N5819',mfr:'Vishay',category:'è‚–ç‰¹åŸºäºŒæç®¡ 40V 1A',price:'Â¥0.03',stock:'1,200,000+',alt:['SS34','SB540']},
                {part:'SS34',mfr:'Taiwan Semi',category:'è‚–ç‰¹åŸºäºŒæç®¡ 3A',price:'Â¥0.03',stock:'850,000+',alt:['1N5819']},
                {part:'1N4007',mfr:'Vishay',category:'æ•´æµäºŒæç®¡ 1000V 1A',price:'Â¥0.01',stock:'3,000,000+',alt:['1N4004']}
            ];
        }
        
        // === æ–°å¢ï¼šLEDé©±åŠ¨ ===
        if(qq.includes('WS2812')||qq.includes('RGB LED')){
            return [
                {part:'WS2812B',mfr:'Worldsemi',category:'RGB LED å†…ç½®é©±åŠ¨',price:'Â¥0.12',stock:'500,000+',alt:['SK6812','PL9823']},
                {part:'SK6812',mfr:'Skylab',category:'RGB LED å…¼å®¹WS2812',price:'Â¥0.10',stock:'350,000+',alt:['WS2812B']},
                {part:'WS2812B-4',mfr:'Worldsemi',category:'RGB LED 4è„š',price:'Â¥0.15',stock:'280,000+',alt:['WS2812B']}
            ];
        }
        
        // === æ–°å¢ï¼šæ—¶é’ŸèŠ¯ç‰‡ ===
        if(qq.includes('DS323')||qq.includes('RTC')){
            return [
                {part:'DS3231',mfr:'Maxim',category:'é«˜ç²¾åº¦RTC I2C',price:'Â¥1.20',stock:'85,000+',alt:['DS1302','PCF8563']},
                {part:'DS1302',mfr:'Maxim',category:'RTCæ—¶é’ŸèŠ¯ç‰‡',price:'Â¥0.40',stock:'65,000+',alt:['DS3231']},
                {part:'PCF8563',mfr:'NXP',category:'ä½åŠŸè€—RTC I2C',price:'Â¥0.35',stock:'55,000+',alt:['DS3231']}
            ];
        }
        
        // === æ–°å¢ï¼šç”µæºæ¨¡å— ===
        if(qq.includes('LM2596')||qq.includes('BUCK')){
            return [
                {part:'LM2596-5.0',mfr:'TI',category:'é™å‹æ¨¡å— 5V 3A',price:'Â¥0.35',stock:'250,000+',alt:['MP1584','XL2596']},
                {part:'MP1584',mfr:'MPS',category:'é™å‹èŠ¯ç‰‡ 3A',price:'Â¥0.30',stock:'180,000+',alt:['LM2596']},
                {part:'XL2596',mfr:'XLSEMI',category:'å›½äº§é™å‹èŠ¯ç‰‡',price:'Â¥0.20',stock:'120,000+',alt:['LM2596']}
            ];
        }
        // é»˜è®¤
        return [
            {part:q.toUpperCase(),mfr:'æœç´¢ç»“æœ',category:'è¯·æŸ¥çœ‹é“¾æ¥è·å–è¯¦æƒ…',price:'å®æ—¶æŸ¥è¯¢',stock:'å®æ—¶æŸ¥è¯¢',alt:[]},
            {part:`${q.toUpperCase()}_ALT`,mfr:'æ›¿ä»£å‹å·',category:'è¯·æŸ¥çœ‹å„å¹³å°',price:'Â¥?.??',stock:'å®æ—¶æŸ¥è¯¢',alt:[]}
        ];
    }

    inp.addEventListener('keypress',e=>{
        if(e.key==='Enter'){
            // Ctrl+Enter ä¿å­˜åˆ°æ”¶è—
            if(e.ctrlKey){
                const q=inp.value.trim();
                const data=partsDB[q.toUpperCase()]||partsDB[Object.keys(partsDB).find(k=>k.toUpperCase()===q.toUpperCase())];
                if(data){
                    addFav(q.toUpperCase(),data.mfr);
                } else {
                    showToast('âš ï¸ æœªæ‰¾åˆ°å™¨ä»¶ï¼Œæ— æ³•æ”¶è—','error');
                }
            } else {
                onlineSearch();
            }
        }
    });
    
    // ESCé”®å…³é—­æ”¶è—é¢æ¿
    document.addEventListener('keydown',e=>{
        if(e.key==='Escape'){
            document.getElementById('favPanel').classList.remove('show');
        }
    });
    
    // åˆå§‹åŒ–
    updateFavUI();
    </script>
</body>
</html>